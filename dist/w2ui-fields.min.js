/* w2ui-fields.js 1.5.x (nightly), part of w2ui (c) http://w2ui.com, vitmalina@gmail.com */

var w2ui=w2ui||{},w2obj=w2obj||{},w2utils=function(m){var e={};return{version:"1.5.x",settings:{locale:"en-us",dateFormat:"m/d/yyyy",timeFormat:"hh:mi pm",datetimeFormat:"m/d/yyyy|hh:mi pm",currencyPrefix:"$",currencySuffix:"",currencyPrecision:2,groupSymbol:",",decimalSymbol:".",shortmonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],fullmonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortdays:["M","T","W","T","F","S","S"],fulldays:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],weekStarts:"M",dataType:"HTTPJSON",phrases:{},dateStartYear:1950,dateEndYear:2030,macButtonOrder:!1},isBin:function(e){return/^[0-1]+$/.test(e)},isInt:c,isFloat:function(e){"string"==typeof e&&(e=e.replace(/\s+/g,"").replace(w2utils.settings.groupSymbol,"").replace(w2utils.settings.decimalSymbol,"."));return("number"==typeof e||"string"==typeof e&&""!==e)&&!isNaN(Number(e))},isMoney:function(e){var t=w2utils.settings,i=new RegExp("^"+(t.currencyPrefix?"\\"+t.currencyPrefix+"?":"")+"[-+]?"+(t.currencyPrefix?"\\"+t.currencyPrefix+"?":"")+"[0-9]*[\\"+t.decimalSymbol+"]?[0-9]+"+(t.currencySuffix?"\\"+t.currencySuffix+"?":"")+"$","i");"string"==typeof e&&(e=e.replace(new RegExp(t.groupSymbol,"g"),""));return"object"!=typeof e&&""!==e&&i.test(e)},isHex:function(e){return/^(0x)?[0-9a-fA-F]+$/.test(e)},isAlphaNumeric:function(e){return/^[a-zA-Z0-9_-]+$/.test(e)},isEmail:function(e){return/^[a-zA-Z0-9._%\-+]+@[а-яА-Яa-zA-Z0-9.-]+\.[а-яА-Яa-zA-Z]+$/.test(e)},isIpAddress:function(e){return new RegExp("^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$").test(e)},isDate:function(e,t,i){if(!e)return!1;var n,s,o,a="Invalid Date";null==t&&(t=w2utils.settings.dateFormat);if("function"==typeof e.getFullYear)o=e.getFullYear(),n=e.getMonth()+1,s=e.getDate();else if(parseInt(e)==e&&0<parseInt(e))e=new Date(parseInt(e)),o=e.getFullYear(),n=e.getMonth()+1,s=e.getDate();else{if(e=String(e),new RegExp("mon","ig").test(t)){t=t.replace(/month/gi,"m").replace(/mon/gi,"m").replace(/dd/gi,"d").replace(/[, ]/gi,"/").replace(/\/\//g,"/").toLowerCase(),e=e.replace(/[, ]/gi,"/").replace(/\/\//g,"/").toLowerCase();for(var r=0,l=w2utils.settings.fullmonths.length;r<l;r++){var d=w2utils.settings.fullmonths[r];e=e.replace(new RegExp(d,"ig"),parseInt(r)+1).replace(new RegExp(d.substr(0,3),"ig"),parseInt(r)+1)}}var u=e.replace(/-/g,"/").replace(/\./g,"/").toLowerCase().split("/"),t=t.replace(/-/g,"/").replace(/\./g,"/").toLowerCase();"mm/dd/yyyy"===t&&(n=u[0],s=u[1],o=u[2]),"m/d/yyyy"===t&&(n=u[0],s=u[1],o=u[2]),"dd/mm/yyyy"===t&&(n=u[1],s=u[0],o=u[2]),"d/m/yyyy"===t&&(n=u[1],s=u[0],o=u[2]),"yyyy/dd/mm"===t&&(n=u[2],s=u[1],o=u[0]),"yyyy/d/m"===t&&(n=u[2],s=u[1],o=u[0]),"yyyy/mm/dd"===t&&(n=u[1],s=u[2],o=u[0]),"yyyy/m/d"===t&&(n=u[1],s=u[2],o=u[0]),"mm/dd/yy"===t&&(n=u[0],s=u[1],o=u[2]),"m/d/yy"===t&&(n=u[0],s=u[1],o=parseInt(u[2])+1900),"dd/mm/yy"===t&&(n=u[1],s=u[0],o=parseInt(u[2])+1900),"d/m/yy"===t&&(n=u[1],s=u[0],o=parseInt(u[2])+1900),"yy/dd/mm"===t&&(n=u[2],s=u[1],o=parseInt(u[0])+1900),"yy/d/m"===t&&(n=u[2],s=u[1],o=parseInt(u[0])+1900),"yy/mm/dd"===t&&(n=u[1],s=u[2],o=parseInt(u[0])+1900),"yy/m/d"===t&&(n=u[1],s=u[2],o=parseInt(u[0])+1900)}if(!c(o))return!1;if(!c(n))return!1;if(!c(s))return!1;if(o=+o,n=+n,s=+s,a=new Date(o,n-1,s),null==n)return!1;if("Invalid Date"===String(a))return!1;if(a.getMonth()+1!==n||a.getDate()!==s||a.getFullYear()!==o)return!1;return!0!==i||a},isTime:function(e,t){if(null==e)return!1;var i,n,s;e=(e=String(e)).toUpperCase(),n=0<=e.indexOf("AM");var o=(s=0<=e.indexOf("PM"))||n;i=o?12:24;e=e.replace("AM","").replace("PM","");var a=(e=m.trim(e)).split(":"),r=parseInt(a[0]||0),l=parseInt(a[1]||0),e=parseInt(a[2]||0);if((!o||1!==a.length)&&2!==a.length&&3!==a.length)return!1;if(""===a[0]||r<0||i<r||!this.isInt(a[0])||2<a[0].length)return!1;if(1<a.length&&(""===a[1]||l<0||59<l||!this.isInt(a[1])||2!==a[1].length))return!1;if(2<a.length&&(""===a[2]||e<0||59<e||!this.isInt(a[2])||2!==a[2].length))return!1;if(!o&&i===r&&(0!==l||0!==e))return!1;if(o&&1===a.length&&0===r)return!1;if(!0!==t)return!0;s&&12!==r&&(r+=12);n&&12===r&&(r+=12);return{hours:r,minutes:l,seconds:e}},isDateTime:function(e,t,i){if("function"==typeof e.getFullYear)return!0!==i||e;var n=parseInt(e);if(n===e)return!(n<0)&&(!0!==i||new Date(n));n=String(e).indexOf(" ");{if(n<0)return!(String(e).indexOf("T")<0||"Invalid Date"==String(new Date(e)))&&(!0!==i||new Date(e));t=(t=null==t?w2utils.settings.datetimeFormat:t).split("|"),n=[e.substr(0,n),e.substr(n).trim()];t[0]=t[0].trim(),t[1]&&(t[1]=t[1].trim());t=w2utils.isDate(n[0],t[0],!0),n=w2utils.isTime(n[1],!0);return!1!==t&&!1!==n&&(!0!==i||(t.setHours(n.hours),t.setMinutes(n.minutes),t.setSeconds(n.seconds),t))}},age:function(e){if(""===e||null==e)return"";i="function"==typeof e.getFullYear?e:parseInt(e)==e&&0<parseInt(e)?new Date(parseInt(e)):new Date(e);if("Invalid Date"===String(i))return"";var t=((new Date).getTime()-i.getTime())/1e3,e="",i="";t<0?(e=0,i="sec"):t<60?(e=Math.floor(t),i="sec",t<0&&(e=0,i="sec")):t<3600?(e=Math.floor(t/60),i="min"):t<86400?(e=Math.floor(t/60/60),i="hour"):t<2592e3?(e=Math.floor(t/24/60/60),i="day"):t<31536e3?(e=Math.floor(t/30/24/60/60*10)/10,i="month"):t<126144e3?(e=Math.floor(t/365/24/60/60*10)/10,i="year"):126144e3<=t&&(e=Math.floor(t/365.25/24/60/60*10)/10,i="year");return e+" "+i+(1<e?"s":"")},interval:function(e){var t="";t=e<1e3?"< 1 sec":e<6e4?Math.floor(e/1e3)+" secs":e<36e5?Math.floor(e/6e4)+" mins":e<864e5?Math.floor(e/36e5*10)/10+" hours":e<2628e6?Math.floor(e/864e5*10)/10+" days":e<31536e6?Math.floor(e/2628e6*10)/10+" months":Math.floor(e/31536e5)/10+" years";return t},date:function(e){if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var t=new Date(e);w2utils.isInt(e)&&(t=new Date(Number(e)));if("Invalid Date"===String(t))return"";var i=w2utils.settings.shortmonths,n=new Date,s=new Date;s.setTime(s.getTime()-864e5);var o=i[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear(),e=i[n.getMonth()]+" "+n.getDate()+", "+n.getFullYear(),n=i[s.getMonth()]+" "+s.getDate()+", "+s.getFullYear(),i=t.getHours()-(12<t.getHours()?12:0)+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+" "+(12<=t.getHours()?"pm":"am"),s=t.getHours()-(12<t.getHours()?12:0)+":"+(t.getMinutes()<10?"0":"")+t.getMinutes()+":"+(t.getSeconds()<10?"0":"")+t.getSeconds()+" "+(12<=t.getHours()?"pm":"am"),t=o;o==e&&(t=i);o==n&&(t=w2utils.lang("Yesterday"));return'<span title="'+o+" "+s+'">'+t+"</span>"},formatSize:function(e){if(!w2utils.isFloat(e)||""===e)return"";if(0===(e=parseFloat(e)))return 0;var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return(Math.floor(e/Math.pow(1024,t)*10)/10).toFixed(0===t?0:1)+" "+(["Bt","KB","MB","GB","TB","PB","EB","ZB"][t]||"??")},formatNumber:function(e,t,i){if(null==e||""===e||"object"==typeof e)return"";i={minimumFractionDigits:t,maximumFractionDigits:t,useGrouping:i};(null==t||t<0)&&(i.minimumFractionDigits=0,i.maximumFractionDigits=20);return parseFloat(e).toLocaleString(w2utils.settings.locale,i)},formatDate:function(e,t){t=t||this.settings.dateFormat;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var i=new Date(e);w2utils.isInt(e)&&(i=new Date(Number(e)));if("Invalid Date"===String(i))return"";var n=i.getFullYear(),e=i.getMonth(),i=i.getDate();return t.toLowerCase().replace("month",w2utils.settings.fullmonths[e]).replace("mon",w2utils.settings.shortmonths[e]).replace(/yyyy/g,n).replace(/yyy/g,n).replace(/yy/g,2e3<n?100+parseInt(String(n).substr(2)):String(n).substr(2)).replace(/(^|[^a-z$])y/g,"$1"+n).replace(/mm/g,(e+1<10?"0":"")+(e+1)).replace(/dd/g,(i<10?"0":"")+i).replace(/th/g,1==i?"st":"th").replace(/th/g,2==i?"nd":"th").replace(/th/g,3==i?"rd":"th").replace(/(^|[^a-z$])m/g,"$1"+(e+1)).replace(/(^|[^a-z$])d/g,"$1"+i)},formatTime:function(e,t){w2utils.settings.shortmonths,w2utils.settings.fullmonths;t=t||this.settings.timeFormat;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";var i=new Date(e);w2utils.isInt(e)&&(i=new Date(Number(e)));w2utils.isTime(e)&&(o=w2utils.isTime(e,!0),(i=new Date).setHours(o.hours),i.setMinutes(o.minutes));if("Invalid Date"===String(i))return"";var n="am",s=i.getHours(),e=i.getHours(),o=i.getMinutes(),i=i.getSeconds();o<10&&(o="0"+o);i<10&&(i="0"+i);-1===t.indexOf("am")&&-1===t.indexOf("pm")||(12<=s&&(n="pm"),12<s&&(s-=12),0===s&&(s=12));return t.toLowerCase().replace("am",n).replace("pm",n).replace("hhh",s<10?"0"+s:s).replace("hh24",e<10?"0"+e:e).replace("h24",e).replace("hh",s).replace("mm",o).replace("mi",o).replace("ss",i).replace(/(^|[^a-z$])h/g,"$1"+s).replace(/(^|[^a-z$])m/g,"$1"+o).replace(/(^|[^a-z$])s/g,"$1"+i)},formatDateTime:function(e,t){var i;if(""===e||null==e||"object"==typeof e&&!e.getMonth)return"";"string"!=typeof t?i=[this.settings.dateFormat,this.settings.timeFormat]:((i=t.split("|"))[0]=i[0].trim(),i[1]=1<i.length?i[1].trim():this.settings.timeFormat);"h12"===i[1]&&(i[1]="h:m pm");"h24"===i[1]&&(i[1]="h24:m");return this.formatDate(e,i[0])+" "+this.formatTime(e,i[1])},stripTags:function(e){if(null==e)return e;switch(typeof e){case"number":break;case"string":e=String(e).replace(/<(?:[^>=]|='[^']*'|="[^"]*"|=[^'"][^\s>]*)*>/gi,"");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.stripTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.stripTags(e[t])}return e},encodeTags:i,decodeTags:function(e){if(null==e)return e;switch(typeof e){case"number":break;case"string":e=String(e).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.decodeTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.decodeTags(e[t])}return e},escapeId:function(e){return""===e||null==e?"":String(e).replace(/([;&,\.\+\*\~'`:"\!\^#$%@\[\]\(\)=<>\|\/? {}\\])/g,"\\$1")},base64encode:function(e){var t,i,n,s,o,a,r="",l=0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=function(e){e=String(e).replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var n=e.charCodeAt(i);n<128?t+=String.fromCharCode(n):(127<n&&n<2048?t+=String.fromCharCode(n>>6|192):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128)),t+=String.fromCharCode(63&n|128))}return t}(e);for(;l<e.length;)a=e.charCodeAt(l++),t=e.charCodeAt(l++),i=e.charCodeAt(l++),n=a>>2,s=(3&a)<<4|t>>4,o=(15&t)<<2|i>>6,a=63&i,isNaN(t)?o=a=64:isNaN(i)&&(a=64),r=r+d.charAt(n)+d.charAt(s)+d.charAt(o)+d.charAt(a);return r},base64decode:function(e){var t,i,n,s,o,a="",r=0,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(;r<e.length;)i=l.indexOf(e.charAt(r++)),n=l.indexOf(e.charAt(r++)),s=l.indexOf(e.charAt(r++)),o=l.indexOf(e.charAt(r++)),t=i<<2|n>>4,i=(15&n)<<4|s>>2,n=(3&s)<<6|o,a+=String.fromCharCode(t),64!==s&&(a+=String.fromCharCode(i)),64!==o&&(a+=String.fromCharCode(n));return a=function(e){var t,i,n="",s=0,o=0;for(;s<e.length;)(o=e.charCodeAt(s))<128?(n+=String.fromCharCode(o),s++):191<o&&o<224?(t=e.charCodeAt(s+1),n+=String.fromCharCode((31&o)<<6|63&t),s+=2):(t=e.charCodeAt(s+1),i=e.charCodeAt(s+2),n+=String.fromCharCode((15&o)<<12|(63&t)<<6|63&i),s+=3);return n}(a)},md5:function(e){var o=0;function t(e){return a(r(s(e),8*e.length))}function i(e){for(var t,i=o?"0123456789ABCDEF":"0123456789abcdef",n="",s=0;s<e.length;s++)t=e.charCodeAt(s),n+=i.charAt(t>>>4&15)+i.charAt(15&t);return n}function n(e){for(var t,i,n="",s=-1;++s<e.length;)t=e.charCodeAt(s),i=s+1<e.length?e.charCodeAt(s+1):0,55296<=t&&t<=56319&&56320<=i&&i<=57343&&(t=65536+((1023&t)<<10)+(1023&i),s++),t<=127?n+=String.fromCharCode(t):t<=2047?n+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}function s(e){for(var t=Array(e.length>>2),i=0;i<t.length;i++)t[i]=0;for(i=0;i<8*e.length;i+=8)t[i>>5]|=(255&e.charCodeAt(i/8))<<i%32;return t}function a(e){for(var t="",i=0;i<32*e.length;i+=8)t+=String.fromCharCode(e[i>>5]>>>i%32&255);return t}function r(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var i=1732584193,n=-271733879,s=-1732584194,o=271733878,a=0;a<e.length;a+=16){var r=i,l=n,d=s,u=o,i=c(i,n,s,o,e[a+0],7,-680876936),o=c(o,i,n,s,e[a+1],12,-389564586),s=c(s,o,i,n,e[a+2],17,606105819),n=c(n,s,o,i,e[a+3],22,-1044525330);i=c(i,n,s,o,e[a+4],7,-176418897),o=c(o,i,n,s,e[a+5],12,1200080426),s=c(s,o,i,n,e[a+6],17,-1473231341),n=c(n,s,o,i,e[a+7],22,-45705983),i=c(i,n,s,o,e[a+8],7,1770035416),o=c(o,i,n,s,e[a+9],12,-1958414417),s=c(s,o,i,n,e[a+10],17,-42063),n=c(n,s,o,i,e[a+11],22,-1990404162),i=c(i,n,s,o,e[a+12],7,1804603682),o=c(o,i,n,s,e[a+13],12,-40341101),s=c(s,o,i,n,e[a+14],17,-1502002290),i=p(i,n=c(n,s,o,i,e[a+15],22,1236535329),s,o,e[a+1],5,-165796510),o=p(o,i,n,s,e[a+6],9,-1069501632),s=p(s,o,i,n,e[a+11],14,643717713),n=p(n,s,o,i,e[a+0],20,-373897302),i=p(i,n,s,o,e[a+5],5,-701558691),o=p(o,i,n,s,e[a+10],9,38016083),s=p(s,o,i,n,e[a+15],14,-660478335),n=p(n,s,o,i,e[a+4],20,-405537848),i=p(i,n,s,o,e[a+9],5,568446438),o=p(o,i,n,s,e[a+14],9,-1019803690),s=p(s,o,i,n,e[a+3],14,-187363961),n=p(n,s,o,i,e[a+8],20,1163531501),i=p(i,n,s,o,e[a+13],5,-1444681467),o=p(o,i,n,s,e[a+2],9,-51403784),s=p(s,o,i,n,e[a+7],14,1735328473),i=h(i,n=p(n,s,o,i,e[a+12],20,-1926607734),s,o,e[a+5],4,-378558),o=h(o,i,n,s,e[a+8],11,-2022574463),s=h(s,o,i,n,e[a+11],16,1839030562),n=h(n,s,o,i,e[a+14],23,-35309556),i=h(i,n,s,o,e[a+1],4,-1530992060),o=h(o,i,n,s,e[a+4],11,1272893353),s=h(s,o,i,n,e[a+7],16,-155497632),n=h(n,s,o,i,e[a+10],23,-1094730640),i=h(i,n,s,o,e[a+13],4,681279174),o=h(o,i,n,s,e[a+0],11,-358537222),s=h(s,o,i,n,e[a+3],16,-722521979),n=h(n,s,o,i,e[a+6],23,76029189),i=h(i,n,s,o,e[a+9],4,-640364487),o=h(o,i,n,s,e[a+12],11,-421815835),s=h(s,o,i,n,e[a+15],16,530742520),i=f(i,n=h(n,s,o,i,e[a+2],23,-995338651),s,o,e[a+0],6,-198630844),o=f(o,i,n,s,e[a+7],10,1126891415),s=f(s,o,i,n,e[a+14],15,-1416354905),n=f(n,s,o,i,e[a+5],21,-57434055),i=f(i,n,s,o,e[a+12],6,1700485571),o=f(o,i,n,s,e[a+3],10,-1894986606),s=f(s,o,i,n,e[a+10],15,-1051523),n=f(n,s,o,i,e[a+1],21,-2054922799),i=f(i,n,s,o,e[a+8],6,1873313359),o=f(o,i,n,s,e[a+15],10,-30611744),s=f(s,o,i,n,e[a+6],15,-1560198380),n=f(n,s,o,i,e[a+13],21,1309151649),i=f(i,n,s,o,e[a+4],6,-145523070),o=f(o,i,n,s,e[a+11],10,-1120210379),s=f(s,o,i,n,e[a+2],15,718787259),n=f(n,s,o,i,e[a+9],21,-343485551),i=m(i,r),n=m(n,l),s=m(s,d),o=m(o,u)}return Array(i,n,s,o)}function l(e,t,i,n,s,o){return m((o=m(m(t,e),m(n,o)))<<(s=s)|o>>>32-s,i)}function c(e,t,i,n,s,o,a){return l(t&i|~t&n,e,t,s,o,a)}function p(e,t,i,n,s,o,a){return l(t&n|i&~n,e,t,s,o,a)}function h(e,t,i,n,s,o,a){return l(t^i^n,e,t,s,o,a)}function f(e,t,i,n,s,o,a){return l(i^(t|~n),e,t,s,o,a)}function m(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}return function(e){return i(t(n(e)))}(e)},transition:function(e,t,i,n){var s=m(e).width(),o=m(e).height();if(!e||!t)return void console.log("ERROR: Cannot do transition when one of the divs is null");switch(e.parentNode.style.cssText+="perspective: 900px; overflow: hidden;",e.style.cssText+="; position: absolute; z-index: 1019; backface-visibility: hidden",t.style.cssText+="; position: absolute; z-index: 1020; backface-visibility: hidden",i){case"slide-left":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d("+s+"px, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(-"+s+"px, 0, 0)"},1);break;case"slide-right":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(-"+s+"px, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0px, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d("+s+"px, 0, 0)"},1);break;case"slide-down":e.style.cssText+="overflow: hidden; z-index: 1; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; z-index: 0; transform: translate3d(0, 0, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(0, "+o+"px, 0)"},1);break;case"slide-up":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(0, "+o+"px, 0)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)",e.style.cssText+="transition: 0.5s; transform: translate3d(0, 0, 0)"},1);break;case"flip-left":e.style.cssText+="overflow: hidden; transform: rotateY(0deg)",t.style.cssText+="overflow: hidden; transform: rotateY(-180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateY(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateY(180deg)"},1);break;case"flip-right":e.style.cssText+="overflow: hidden; transform: rotateY(0deg)",t.style.cssText+="overflow: hidden; transform: rotateY(180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateY(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateY(-180deg)"},1);break;case"flip-down":e.style.cssText+="overflow: hidden; transform: rotateX(0deg)",t.style.cssText+="overflow: hidden; transform: rotateX(180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateX(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateX(-180deg)"},1);break;case"flip-up":e.style.cssText+="overflow: hidden; transform: rotateX(0deg)",t.style.cssText+="overflow: hidden; transform: rotateX(-180deg)",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: rotateX(0deg)",e.style.cssText+="transition: 0.5s; transform: rotateX(180deg)"},1);break;case"pop-in":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); transform: scale(.8); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; transform: scale(1); opacity: 1;",e.style.cssText+="transition: 0.5s;"},1);break;case"pop-out":e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); transform: scale(1); opacity: 1;",t.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; opacity: 1;",e.style.cssText+="transition: 0.5s; transform: scale(1.7); opacity: 0;"},1);break;default:e.style.cssText+="overflow: hidden; transform: translate3d(0, 0, 0)",t.style.cssText+="overflow: hidden; translate3d(0, 0, 0); opacity: 0;",m(t).show(),window.setTimeout(function(){t.style.cssText+="transition: 0.5s; opacity: 1;",e.style.cssText+="transition: 0.5s"},1)}setTimeout(function(){"slide-down"===i&&(m(e).css("z-index","1019"),m(t).css("z-index","1020")),t&&m(t).css({opacity:"1"}).css(w2utils.cssPrefix({transition:"",transform:""})),e&&m(e).css({opacity:"1"}).css(w2utils.cssPrefix({transition:"",transform:""})),"function"==typeof n&&n()},500)},lock:function(e,t,i){var n={};"object"==typeof t?n=t:(n.msg=t,n.spinner=i);n.msg||0===n.msg||(n.msg="");w2utils.unlock(e),m(e).prepend('<div class="w2ui-lock"></div><div class="w2ui-lock-msg"></div>');i=m(e).find(".w2ui-lock"),e=m(e).find(".w2ui-lock-msg");n.msg||e.css({"background-color":"transparent",border:"0px"});!0===n.spinner&&(n.msg='<div class="w2ui-spinner" '+(n.msg?"":'style="width: 35px; height: 35px"')+"></div>"+n.msg);null!=n.opacity&&i.css("opacity",n.opacity);"function"==typeof i.fadeIn?(i.fadeIn(200),e.html(n.msg).fadeIn(200)):(i.show(),e.html(n.msg).show(0))},unlock:function(e,t){c(t)?(m(e).find(".w2ui-lock").fadeOut(t),setTimeout(function(){m(e).find(".w2ui-lock").remove(),m(e).find(".w2ui-lock-msg").remove()},t)):(m(e).find(".w2ui-lock").remove(),m(e).find(".w2ui-lock-msg").remove())},message:function(n,e){var t,s,o=this;m().w2tag(),e=e||{width:200,height:100};null==e.on&&m.extend(e,w2utils.event);null==e.width&&(e.width=200);null==e.height&&(e.height=100);var i=parseInt(m(n.box).width()),a=parseInt(m(n.box).height()),r=parseInt(m(n.box).find(n.title).css("height")||0);e.width>i&&(e.width=i-10);e.height>a-r&&(e.height=a-10-r);e.originalWidth=e.width,e.originalHeight=e.height,parseInt(e.width)<0&&(e.width=i+e.width);parseInt(e.width)<10&&(e.width=10);parseInt(e.height)<0&&(e.height=a+e.height-r);parseInt(e.height)<10&&(e.height=10);null==e.hideOnClick&&(e.hideOnClick=!1);var l=m(n.box).data("options")||{};(null==e.width||e.width>l.width-10)&&(e.width=l.width-10);(null==e.height||e.height>l.height-r-5)&&(e.height=l.height-r-5);e.originalHeight<0&&(e.height=a+e.originalHeight-r);e.originalWidth<0&&(e.width=i+2*e.originalWidth);var d=m(n.box).find(n.title),r=m(n.box).find(".w2ui-message.w2ui-closing");0<m(n.box).find(".w2ui-message.w2ui-closing").length&&(clearTimeout(t),h(r,r.data("options")||{}));var u=m(n.box).find(".w2ui-message").length;if(""===m.trim(e.html)&&""===m.trim(e.body)&&""===m.trim(e.buttons)){var c;0!==u&&(c=m(n.box).find("#w2ui-message"+(u-1)),e=c.data("options")||{},!0!==(s=e.trigger({phase:"before",type:"close",target:"self"})).isCancelled&&(c.css(w2utils.cssPrefix({transition:"0.15s",transform:"translateY(-"+e.height+"px)"})).addClass("w2ui-closing"),1===u?this.unlock&&(n.param?this.unlock(n.param,150):this.unlock(150)):m(n.box).find("#w2ui-message"+(u-2)).css("z-index",1500),t=setTimeout(function(){h(c,e)},150)))}else{""===m.trim(e.body)&&""===m.trim(e.buttons)||(e.html='<div class="w2ui-message-body">'+(e.body||"")+'</div><div class="w2ui-message-buttons">'+(e.buttons||"")+"</div>"),m(n.box).find(".w2ui-message").css("z-index",1390),d.data("old-z-index",d.css("z-index")),d.css("z-index",1501),m(n.box).find(n.body).before('<div id="w2ui-message'+u+'" onmousedown="event.stopPropagation();"    class="w2ui-message" style="display: none; z-index: 1500; '+(0===d.length?"top: 0px;":"top: "+w2utils.getSize(d,"height")+"px;")+(null!=e.width?"width: "+e.width+"px; left: "+(i-e.width)/2+"px;":"left: 10px; right: 10px;")+(null!=e.height?"height: "+e.height+"px;":"bottom: 6px;")+w2utils.cssPrefix("transition",".3s",!0)+'"'+(!0===e.hideOnClick?n.param?'onclick="'+n.path+".message('"+n.param+"');\"":'onclick="'+n.path+'.message();"':"")+"></div>"),m(n.box).find("#w2ui-message"+u).data("options",e).data("prev_focus",m(":focus"));var p=m(n.box).find("#w2ui-message"+u).css("display");if(m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transform:"none"===p?"translateY(-"+e.height+"px)":"translateY(0px)"})),"none"===p){if(m(n.box).find("#w2ui-message"+u).show().html(e.html),e.box=m(n.box).find("#w2ui-message"+u),!0===(s=e.trigger({phase:"before",type:"open",target:"self"})).isCancelled)return d.css("z-index",d.data("old-z-index")),void m(n.box).find("#w2ui-message"+u).remove();setTimeout(function(){m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transform:"none"===p?"translateY(0px)":"translateY(-"+e.height+"px)"}))},1),0===u&&this.lock&&(n.param?this.lock(n.param):this.lock()),setTimeout(function(){m(n.box).find("#w2ui-message"+u).css(w2utils.cssPrefix({transition:"0s"})),e.trigger(m.extend(s,{phase:"after"}))},350)}}function h(e,t){if(null==s&&!0===(s=t.trigger({phase:"before",type:"open",target:"self"})).isCancelled)return d.css("z-index",d.data("old-z-index")),void m(n.box).find("#w2ui-message"+u).remove();var i=e.data("prev_focus");e.remove(),i&&0<i.length?i.focus():o&&o.focus&&o.focus(),d.css("z-index",d.data("old-z-index")),t.trigger(m.extend(s,{phase:"after"}))}},naturalCompare:function(e,t){var n,i,s=1,o=0,a=0,r=String.alphabet;function l(e,t,i){if(i){for(n=t;(i=l(e,n))<76&&65<i;)++n;return+e.slice(t-1,n)}return-1<(i=r&&r.indexOf(e.charAt(t)))?i+76:(i=e.charCodeAt(t)||0)<45||127<i?i:i<46?65:i<48?i-1:i<58?i+18:i<65?i-11:i<91?i+11:i<97?i-37:i<123?i+5:i-63}if((e+="")!=(t+=""))for(;s;)if(i=l(e,o++),s=l(t,a++),i<76&&s<76&&66<i&&66<s&&(i=l(e,o,o),s=l(t,a,o=n),a=n),i!=s)return i<s?-1:1;return 0},lang:function(e){var t=this.settings.phrases[e];return null==t?e:t},locale:function(n,s){n=n||"en-us";if("string"!=typeof n)return void(w2utils.settings=m.extend(!0,w2utils.settings,n));5===n.length&&(n="locale/"+n+".json");w2utils.settings.phrases={},m.ajax({url:n,type:"GET",dataType:"JSON",success:function(e,t,i){w2utils.settings=m.extend(!0,w2utils.settings,e),"function"==typeof s&&s()},error:function(e,t,i){console.log("ERROR: Cannot load locale "+n)}})},getSize:function(e,t){var i=m(e),n=parseInt(i.css("border-left-width"))||0,s=parseInt(i.css("border-right-width"))||0,o=parseInt(i.css("border-top-width"))||0,a=parseInt(i.css("border-bottom-width"))||0,r=parseInt(i.css("margin-left"))||0,l=parseInt(i.css("margin-right"))||0,d=parseInt(i.css("margin-top"))||0,u=parseInt(i.css("margin-bottom"))||0,c=parseInt(i.css("padding-left"))||0,p=parseInt(i.css("padding-right"))||0,h=parseInt(i.css("padding-top"))||0,f=parseInt(i.css("padding-bottom"))||0;switch(t){case"top":return o+d+h;case"bottom":return a+u+f;case"left":return n+r+c;case"right":return s+l+p;case"width":return n+s+r+l+c+p+parseInt(i.width());case"height":return o+a+d+u+h+f+parseInt(i.height());case"+width":return n+s+r+l+c+p;case"+height":return o+a+d+u+h+f}return 0},getStrWidth:function(e,t){var e='<div id="_tmp_width" style="position: absolute; top: -900px;'+(t||"")+'">'+i(e)+"</div>";return m("body").append(e),e=m("#_tmp_width").width(),m("#_tmp_width").remove(),e},scrollBarSize:function(){if(e.scrollBarSize)return e.scrollBarSize;m("body").append('<div id="_scrollbar_width" style="position: absolute; top: -300px; width: 100px; height: 100px; overflow-y: scroll;">    <div style="height: 120px">1</div></div>'),e.scrollBarSize=100-m("#_scrollbar_width > div").width(),m("#_scrollbar_width").remove(),0<=String(navigator.userAgent).indexOf("MSIE")&&(e.scrollBarSize=e.scrollBarSize/2);return e.scrollBarSize},checkName:function(e,t){return e&&null!=e.name?null==w2ui[e.name]?!!w2utils.isAlphaNumeric(e.name)||(console.log('ERROR: The parameter "name" has to be alpha-numeric (a-z, 0-9, dash and underscore). '),!1):(console.log('ERROR: The parameter "name" is not unique. There are other objects already created with the same name (obj: '+e.name+")."),!1):(console.log('ERROR: The parameter "name" is required but not supplied in $().'+t+"()."),!1)},checkUniqueId:function(e,t,i,n){m.isArray(t)||(t=[t]);for(var s=0;s<t.length;s++)if(t[s].id===e)return console.log('ERROR: The parameter "id='+e+'" is not unique within the current '+i+". (obj: "+n+")"),!1;return!0},parseRoute:function(e){var a=[],e=e.replace(/\/\(/g,"(?:/").replace(/\+/g,"__plus__").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,t,i,n,s,o){return a.push({name:n,optional:!!o}),t=t||"",(o?"":t)+"(?:"+(o?t:"")+(i||"")+(s||(i?"([^/.]+?)":"([^/]+?)"))+")"+(o||"")}).replace(/([\/.])/g,"\\$1").replace(/__plus__/g,"(.+)").replace(/\*/g,"(.*)");return{path:new RegExp("^"+e+"$","i"),keys:a}},cssPrefix:function(e,t,i){var n={},s={},o="";m.isPlainObject(e)?(n=e,!0===t&&(i=!0)):n[e]=t;for(a in n)s[a]=n[a],s["-webkit-"+a]=n[a],s["-moz-"+a]=n[a].replace("-webkit-","-moz-"),s["-ms-"+a]=n[a].replace("-webkit-","-ms-"),s["-o-"+a]=n[a].replace("-webkit-","-o-");if(!0===i)for(var a in s)o+=a+": "+s[a]+"; ";else o=s;return o},parseColor:function(e){{if("string"!=typeof e)return null;e=e.trim().toUpperCase()}"#"===e[0]&&(e=e.substr(1));var t={};if(3===e.length)t={r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:1};else if(6===e.length)t={r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:1};else if(8===e.length)t={r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:Math.round(parseInt(e.substr(6,2),16)/255*100)/100};else if(4<e.length&&"RGB("===e.substr(0,4)){var i=e.replace("RGB","").replace(/\(/g,"").replace(/\)/g,"").split(",");t={r:parseInt(i[0],10),g:parseInt(i[1],10),b:parseInt(i[2],10),a:1}}else{if(!(5<e.length&&"RGBA("===e.substr(0,5)))return null;i=e.replace("RGBA","").replace(/\(/g,"").replace(/\)/g,"").split(",");t={r:parseInt(i[0],10),g:parseInt(i[1],10),b:parseInt(i[2],10),a:parseFloat(i[3])}}return t},hsv2rgb:function(e,t,i,n){var s,o,a,r,l,d,u,c;1===arguments.length&&(t=e.s,i=e.v,n=e.a,e=e.h);switch(e/=360,t/=100,i/=100,r=Math.floor(6*e),d=i*(1-t),u=i*(1-(l=6*e-r)*t),c=i*(1-(1-l)*t),r%6){case 0:s=i,o=c,a=d;break;case 1:s=u,o=i,a=d;break;case 2:s=d,o=i,a=c;break;case 3:s=d,o=u,a=i;break;case 4:s=c,o=d,a=i;break;case 5:s=i,o=d,a=u}return{r:Math.round(255*s),g:Math.round(255*o),b:Math.round(255*a),a:null!=n?n:1}},rgb2hsv:function(e,t,i,n){1===arguments.length&&(t=e.g,i=e.b,n=e.a,e=e.r);var s,o=Math.max(e,t,i),a=Math.min(e,t,i),r=o-a,l=0===o?0:r/o,d=o/255;switch(o){case a:s=0;break;case e:s=t-i+r*(t<i?6:0),s/=6*r;break;case t:s=i-e+2*r,s/=6*r;break;case i:s=e-t+4*r,s/=6*r}return{h:Math.round(360*s),s:Math.round(100*l),v:Math.round(100*d),a:null!=n?n:1}},tooltip:function(e,t){var i="mouseenter",n="mouseleave";(t=t||{}).showOn&&(i=t.showOn,delete t.showOn);t.hideOn&&(n=t.hideOn,delete t.hideOn);return"on"+i+"=\"$(this).w2tag(w2utils.base64decode('"+w2utils.base64encode(e)+"'),JSON.parse(w2utils.base64decode('"+w2utils.base64encode(JSON.stringify(t))+"')))\"on"+n+'="$(this).w2tag()"'},getCursorPosition:function(e){if(null==e)return null;var t=0,i=e.ownerDocument||e.document,n=i.defaultView||i.parentWindow;{var s,o;e.tagName&&"INPUT"===e.tagName.toUpperCase()&&e.selectionStart?t=e.selectionStart:n.getSelection?0<(o=n.getSelection()).rangeCount&&(s=o.getRangeAt(0),(n=s.cloneRange()).selectNodeContents(e),n.setEnd(s.endContainer,s.endOffset),t=n.toString().length):(o=i.selection)&&"Control"!==o.type&&(o=o.createRange(),(i=i.body.createTextRange()).moveToElementText(e),i.setEndPoint("EndToEnd",o),t=i.text.length)}return t},setCursorPosition:function(e,t,i){var n,s=document.createRange(),o=window.getSelection();if(null==e)return;for(var a=0;a<e.childNodes.length;a++){var r=m(e.childNodes[a]).text();if(e.childNodes[a].tagName&&(r=(r=m(e.childNodes[a]).html()).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")),t<=r.length){(n=(n=e.childNodes[a]).childNodes&&0<n.childNodes.length?n.childNodes[0]:n).childNodes&&0<n.childNodes.length&&(n=n.childNodes[0]);break}t-=r.length}if(null==n)return;t>n.length&&(t=n.length);s.setStart(n,t),i?s.setEnd(n,i):s.collapse(!0);o.removeAllRanges(),o.addRange(s)},testLocalStorage:t,hasLocalStorage:t(),isIOS:-1!==navigator.userAgent.toLowerCase().indexOf("iphone")||-1!==navigator.userAgent.toLowerCase().indexOf("ipod")||-1!==navigator.userAgent.toLowerCase().indexOf("ipad")||-1!==navigator.userAgent.toLowerCase().indexOf("mobile")||-1!==navigator.userAgent.toLowerCase().indexOf("android"),isIE:-1!==navigator.userAgent.toLowerCase().indexOf("msie")||-1!==navigator.userAgent.toLowerCase().indexOf("trident")};function c(e){return/^[-+]?[0-9]+$/.test(e)}function i(e){if(null==e)return e;switch(typeof e){case"number":break;case"string":e=String(e).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;");break;case"object":if(Array.isArray(e)){e=m.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=this.encodeTags(e[t])}else for(var t in e=m.extend(!0,{},e))e[t]=this.encodeTags(e[t])}return e}function t(){var e="w2ui_test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return!1}}}(jQuery);w2utils.formatters={number:function(e,t){return 20<parseInt(t)&&(t=20),parseInt(t)<0&&(t=0),null==e||""===e?"":w2utils.formatNumber(parseFloat(e),t,!0)},float:function(e,t){return w2utils.formatters.number(e,t)},int:function(e,t){return w2utils.formatters.number(e,0)},money:function(e,t){if(null==e||""===e)return"";e=w2utils.formatNumber(Number(e),w2utils.settings.currencyPrecision||2);return(w2utils.settings.currencyPrefix||"")+e+(w2utils.settings.currencySuffix||"")},currency:function(e,t){return w2utils.formatters.money(e,t)},percent:function(e,t){return null==e||""===e?"":w2utils.formatNumber(e,t||1)+"%"},size:function(e,t){return null==e||""===e?"":w2utils.formatSize(parseInt(e))},date:function(e,t){if(""===t&&(t=w2utils.settings.dateFormat),null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,t,!0);return'<span title="'+(i=!1===i?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatDate(i,t)+"</span>"},datetime:function(e,t){if(""===t&&(t=w2utils.settings.datetimeFormat),null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,t,!0);return'<span title="'+(i=!1===i?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatDateTime(i,t)+"</span>"},time:function(e,t){if("h24"===(t="h12"===(t=""===t?w2utils.settings.timeFormat:t)?"hh:mi pm":t)&&(t="h24:mi"),null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,t,!0);return'<span title="'+(i=!1===i?w2utils.isDate(e,t,!0):i)+'">'+w2utils.formatTime(e,t)+"</span>"},timestamp:function(e,t){if(""===t&&(t=w2utils.settings.datetimeFormat),null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,t,!0);return(i=!1===i?w2utils.isDate(e,t,!0):i).toString?i.toString():""},gmt:function(e,t){if(""===t&&(t=w2utils.settings.datetimeFormat),null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,t,!0);return(i=!1===i?w2utils.isDate(e,t,!0):i).toUTCString?i.toUTCString():""},age:function(e,t){if(null==e||0===e||""===e)return"";var i=w2utils.isDateTime(e,null,!0);return'<span title="'+(i=!1===i?w2utils.isDate(e,null,!0):i)+'">'+w2utils.age(e)+(t?" "+t:"")+"</span>"},interval:function(e,t){return null==e||0===e||""===e?"":w2utils.interval(e)+(t?" "+t:"")},toggle:function(e,t){return e?"Yes":""},password:function(e,t){for(var i="",n=0;n<e.length;n++)i+="*";return i}},w2utils.event={on:function(e,t){var i,n,s=jQuery;"string"==typeof e&&-1!==e.indexOf(".")&&(e=(n=e.split("."))[0],i=n[1]),"string"==typeof e&&-1!==e.indexOf(":")&&(n=e.split(":"),-1!==["complete","done"].indexOf(e[1])&&(e[1]="after"),e={type:n[0],execute:n[1]}),s.isPlainObject(e)||(e={type:e,scope:i}),(e=s.extend({type:null,execute:"before",target:null,onComplete:null},e)).type?t?(s.isArray(this.handlers)||(this.handlers=[]),this.handlers.push({edata:e,handler:t})):console.log("ERROR: You must specify event handler function when calling .on() method of "+this.name):console.log("ERROR: You must specify event type when calling .on() method of "+this.name)},off:function(e,t){var i,n,s=jQuery;if("string"==typeof e&&-1!==e.indexOf(".")&&(e=(n=e.split("."))[0],i=n[1],""===e&&(e="*")),"string"==typeof e&&-1!==e.indexOf(":")&&(n=e.split(":"),-1!==["complete","done"].indexOf(e[1])&&(e[1]="after"),e={type:n[0],execute:n[1]}),s.isPlainObject(e)||(e={type:e}),(e=s.extend({},{type:null,execute:null,target:null,onComplete:null},e)).type||i){t=t||null;for(var o=[],a=0,r=this.handlers.length;a<r;a++){var l=this.handlers[a];(l.edata.type!==e.type&&"*"!==e.type&&(null==l.edata.scope||""!=e.type)||l.edata.target!==e.target&&null!=e.target||l.edata.execute!==e.execute&&null!=e.execute||!(l.handler===t&&null!=t||null!=i&&l.edata.scope==i))&&o.push(l)}this.handlers=o}else console.log("ERROR: You must specify event type when calling .off() method of "+this.name)},trigger:function(e){var t,i,n,s=jQuery;"before"===(e=s.extend({type:null,phase:"before",target:null,doneHandlers:[]},e,{isStopped:!1,isCancelled:!1,done:function(e){this.doneHandlers.push(e)},preventDefault:function(){this.isCancelled=!0},stopPropagation:function(){this.isStopped=!0}})).phase&&(e.onComplete=null),null==e.target&&(e.target=null),s.isArray(this.handlers)||(this.handlers=[]);for(var o=this.handlers.length-1;0<=o;o--){var a=this.handlers[o];if(!(null==a||a.edata.type!==e.type&&"*"!==a.edata.type||a.edata.target!==e.target&&null!=a.edata.target||a.edata.execute!==e.phase&&"*"!==a.edata.execute&&"*"!==a.edata.phase)&&(e=s.extend({},a.edata,e),t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(a.handler))?n[1].split(/\s*,\s*/):t).length?a.handler.call(this,e.target,e):a.handler.call(this,e),!0===e.isStopped||!0===e.stop))return e}var r="on"+e.type.substr(0,1).toUpperCase()+e.type.substr(1);if("before"===e.phase&&"function"==typeof this[r]&&(i=this[r],t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(i))?n[1].split(/\s*,\s*/):t).length?i.call(this,e.target,e):i.call(this,e),!0===e.isStopped||!0===e.stop))return e;if(null!=e.object&&"before"===e.phase&&"function"==typeof e.object[r]&&(i=e.object[r],t=[],2===(t=(n=new RegExp(/\((.*?)\)/).exec(i))?n[1].split(/\s*,\s*/):t).length?i.call(this,e.target,e):i.call(this,e),!0===e.isStopped||!0===e.stop))return e;if("after"===e.phase){"function"==typeof e.onComplete&&e.onComplete.call(this,e);for(var l=0;l<e.doneHandlers.length;l++)"function"==typeof e.doneHandlers[l]&&e.doneHandlers[l].call(this,e)}return e}},function(y){y.fn.w2render=function(e){0<y(this).length&&("string"==typeof e&&w2ui[e]&&w2ui[e].render(y(this)[0]),"object"==typeof e&&e.render(y(this)[0]))},y.fn.w2destroy=function(e){"string"==typeof(e=!e&&0<this.length?this.attr("name"):e)&&w2ui[e]&&w2ui[e].destroy(),"object"==typeof e&&e.destroy()},y.fn.w2marker=function(){var o=Array.prototype.slice.call(arguments,0);return 0!==(o=Array.isArray(o[0])?o[0]:o).length&&o[0]?y(this).each(function(e,t){a(0,t);for(var i=0;i<o.length;i++){var n=(n="string"!=typeof(n=o[i])?String(n):n).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace(/&/g,"&amp;").replace(/</g,"&gt;").replace(/>/g,"&lt;"),n=new RegExp(n+"(?!([^<]+)?>)","gi");t.innerHTML=t.innerHTML.replace(n,s)}function s(e){return'<span class="w2ui-marker">'+e+"</span>"}}):y(this).each(a);function a(e,t){for(;-1!==t.innerHTML.indexOf('<span class="w2ui-marker">');)t.innerHTML=t.innerHTML.replace(/\<span class=\"w2ui\-marker\"\>((.|\n|\r)*)\<\/span\>/gi,"$1")}},y.fn.w2tag=function(r,l){if(1===arguments.length&&"object"==typeof r&&null!=(l=r).html&&(r=l.html),null!=(l=y.extend({id:null,auto:null,html:r,position:"right|top",align:"none",left:0,top:0,maxWidth:null,style:"",css:{},className:"",inputClass:"",onShow:null,onHide:null,hideOnKeyPress:!0,hideOnFocus:!1,hideOnBlur:!1,hideOnClick:!1,hideOnChange:!0},l)).name&&null==l.id&&(l.id=l.name),""!==l.class&&""===l.inputClass&&(l.inputClass=l.class),0!==y(this).length)return!0===l.auto||null!=l.showOn||null!=l.hideOn?0!=arguments.length&&r?y(this).each(function(e,t){var i="mouseenter",n="mouseleave";l.showOn&&(i=String(l.showOn).toLowerCase(),delete l.showOn),l.hideOn&&(n=String(l.hideOn).toLowerCase(),delete l.hideOn),l.potision||(l.position="top|bottom"),y(t).off(".w2tooltip").on(i+".w2tooltip",function(){l.auto=!1,y(this).w2tag(r,l)}).on(n+".w2tooltip",function(){y(this).w2tag()})}):y(this).each(function(e,t){y(t).off(".w2tooltip")}):y(this).each(function(e,t){var c,i=(i=""==(i=l.id||t.id)?y(t).find("input").attr("id"):i)||"noid",n=w2utils.escapeId(i);function s(){var e;c.box.css("display","block"),c&&c.box&&y(c.attachedTo).offset()&&(e=c.getPos(),c.box.css({opacity:"1",left:e.left+"px",top:e.top+"px"}).data("w2tag",c).find(".w2ui-tag-body").addClass(e.posClass),c.tmp.pos=e.left+"x"+e.top,y(c.attachedTo).off(".w2tag").css(c.options.css).addClass(c.options.inputClass),c.options.hideOnKeyPress&&y(c.attachedTo).on("keypress.w2tag",c.hide),c.options.hideOnFocus&&y(c.attachedTo).on("focus.w2tag",c.hide),l.hideOnChange&&("INPUT"===t.nodeName?y(t):y(t).find("input")).on("change.w2tag",c.hide),c.options.hideOnBlur&&y(c.attachedTo).on("blur.w2tag",c.hide),c.options.hideOnClick&&y("body").on("click.w2tag"+(c.id||""),c.hide),"function"==typeof c.options.onShow&&c.options.onShow(),o())}function o(e){var t=y(c.attachedTo).offset();0===y(c.attachedTo).length||0===t.left&&0===t.top||0===c.box.find(".w2ui-tag-body").length?c.hide():(t=a(),c.tmp.pos!==t.left+"x"+t.top&&(c.box.css(w2utils.cssPrefix({transition:e?"0s":".2s"})).css({left:t.left+"px",top:t.top+"px"}),c.tmp.pos=t.left+"x"+t.top),c.tmp.timer&&clearTimeout(c.tmp.timer),c.tmp.timer=setTimeout(o,100))}function a(){var e=y(c.attachedTo).offset(),t="w2ui-tag-right",i=parseInt(e.left+c.attachedTo.offsetWidth+(c.options.left||0)),n=parseInt(e.top+(c.options.top||0)),s=c.box.find(".w2ui-tag-body"),o=s[0].offsetWidth,a=s[0].offsetHeight;if("string"==typeof c.options.position&&-1!==c.options.position.indexOf("|")&&(c.options.position=c.options.position.split("|")),"top"===c.options.position)t="w2ui-tag-top",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+(c.options.top||0))-a-10;else if("bottom"===c.options.position)t="w2ui-tag-bottom",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+c.attachedTo.offsetHeight+(c.options.top||0))+10;else if("left"===c.options.position)t="w2ui-tag-left",i=parseInt(e.left+(c.options.left||0))-o-20,n=parseInt(e.top+(c.options.top||0));else if(Array.isArray(c.options.position)){for(var r=window.innerWidth,l=window.innerHeight,d=0;d<c.options.position.length;d++){var u=c.options.position[d];if("right"===u){if(t="w2ui-tag-right",i=parseInt(e.left+c.attachedTo.offsetWidth+(c.options.left||0)),n=parseInt(e.top+(c.options.top||0)),i+o<=r)break}else if("left"===u){if(t="w2ui-tag-left",i=parseInt(e.left+(c.options.left||0))-o-20,n=parseInt(e.top+(c.options.top||0)),0<=i)break}else if("top"===u){if(t="w2ui-tag-top",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+(c.options.top||0))-a-10,i+o<=r&&0<=n)break}else if("bottom"===u&&(t="w2ui-tag-bottom",i=parseInt(e.left+(c.options.left||0))-14,n=parseInt(e.top+c.attachedTo.offsetHeight+(c.options.top||0))+10,i+o<=r&&n+a<=l))break}s.data("posClass")!==t&&s.removeClass("w2ui-tag-right w2ui-tag-left w2ui-tag-top w2ui-tag-bottom").addClass(t).data("posClass",t)}return{left:i,top:n,posClass:t}}null!=y(this).data("w2tag")?(c=y(this).data("w2tag"),y.extend(c.options,l)):c={id:i,attachedTo:t,box:y("#w2ui-tag-"+n),options:y.extend({},l),init:s,hide:function(){if(c.box.length<=0)return;c.tmp.timer&&clearTimeout(c.tmp.timer);c.box.remove(),c.options.hideOnClick&&y("body").off(".w2tag"+(c.id||""));y(c.attachedTo).off(".w2tag").removeClass(c.options.inputClass).removeData("w2tag"),0<y(c.attachedTo).length&&(y(c.attachedTo)[0].style.cssText=c.tmp.originalCSS);"function"==typeof c.options.onHide&&c.options.onHide()},getPos:a,isMoved:o,tmp:{}},""===r||null==r?c.hide():0!==c.box.length?c.box.find(".w2ui-tag-body").css(c.options.css).attr("style",c.options.style).addClass(c.options.className).html(c.options.html):(c.tmp.originalCSS="",0<y(c.attachedTo).length&&(c.tmp.originalCSS=y(c.attachedTo)[0].style.cssText),i="white-space: nowrap;",c.options.maxWidth&&w2utils.getStrWidth(r)>c.options.maxWidth&&(i="width: "+c.options.maxWidth+"px"),y("body").append('<div onclick="event.stopPropagation()" style="display: none;" id="w2ui-tag-'+c.id+'"        class="w2ui-tag '+(0<y(c.attachedTo).parents(".w2ui-popup, .w2ui-overlay-popup, .w2ui-message").length?"w2ui-tag-popup":"")+'">   <div style="margin: -2px 0px 0px -2px; '+i+'">      <div class="w2ui-tag-body '+c.options.className+'" style="'+(c.options.style||"")+'">'+r+"</div>   </div></div>"),c.box=y("#w2ui-tag-"+n),y(c.attachedTo).data("w2tag",c),setTimeout(s,1))});y(".w2ui-tag").each(function(e,t){t=y(t).data("w2tag");t&&t.hide()})},y.fn.w2overlay=function(e,f){var m=this,g="";if(1===arguments.length&&(f="object"==typeof e?e:{html:e}),2===arguments.length&&(f.html=e),y.isPlainObject(f)||(f={}),(f=y.extend({},{name:null,html:"",align:"none",left:0,top:0,tipLeft:30,noTip:!1,selectable:!1,width:0,height:0,maxWidth:null,maxHeight:null,contextMenu:!1,pageX:null,pageY:null,originalEvent:null,style:"",class:"",overlayStyle:"",onShow:null,onHide:null,openAbove:!1,tmp:{}},f)).name&&(g="-"+f.name),0===this.length||""===f.html||null==f.html)return 0<y("#w2ui-overlay"+g).length?"function"==typeof(n=y("#w2ui-overlay"+g)[0].hide)&&n():y("#w2ui-overlay"+g).remove(),y(this);0<y("#w2ui-overlay"+g).length&&(n=y("#w2ui-overlay"+g)[0].hide,y(document).off(".w2overlay"+g),"function"==typeof n&&n()),0<m.length&&(null==m[0].tagName||"BODY"===m[0].tagName.toUpperCase())&&(f.contextMenu=!0),f.contextMenu&&f.originalEvent&&(f.pageX=f.originalEvent.pageX,f.pageY=f.originalEvent.pageY),!f.contextMenu||null!=f.pageX&&null!=f.pageY||console.log("ERROR: to display menu at mouse location, pass options.pageX and options.pageY.");var t="";f.data&&Object.keys(f.data).forEach(function(e){t+="data-"+e+'="'+f.data[e]+'"'}),y("body").append('<div id="w2ui-overlay'+g+'" style="display: none; left: 0px; top: 0px; '+f.overlayStyle+'" '+t+'        class="w2ui-reset w2ui-overlay '+(0<y(this).parents(".w2ui-popup, .w2ui-overlay-popup, .w2ui-message").length?"w2ui-overlay-popup":"")+'">    <style></style>    <div style="min-width: 100%; '+f.style+'" class="'+f.class+'"></div></div>');var i=y("#w2ui-overlay"+g),n=i.find(" > div");n.html(f.html);n=n.css("background-color");null!=n&&"rgba(0, 0, 0, 0)"!==n&&"transparent"!==n&&i.css({"background-color":n,"border-color":n});n=y(m).offset()||{};return i.data("element",0<m.length?m[0]:null).data("options",f).data("position",n.left+"x"+n.top).fadeIn("fast").on("click",function(e){y("#w2ui-overlay"+g).data("keepOpen",!0),"LABEL"===e.target.tagName.toUpperCase()&&e.stopPropagation()}).on("mousedown",function(e){var t=e.target.tagName.toUpperCase();-1!==["INPUT","TEXTAREA","SELECT"].indexOf(t)||f.selectable||e.preventDefault()}),i[0].hide=s,i[0].resize=w,setTimeout(function(){y(document).off(".w2overlay"+g).on("click.w2overlay"+g,s),"function"==typeof f.onShow&&f.onShow(),w()},10),function e(){var t=y("#w2ui-overlay"+g);if(t.data("element")!==m[0])return;if(0===t.length)return;var i=y(m).offset()||{};var i=i.left+"x"+i.top;t.data("position")!==i?s():setTimeout(e,250)}(),y(this);function s(e){var t,i;e&&0!==e.button||(t=y("#w2ui-overlay"+g),e&&y(y(e.target).closest(".w2ui-overlay").data("element")).closest(".w2ui-overlay")[0]===t[0]||(!0!==t.data("keepOpen")?!1!==(i="function"==typeof f.onHide?f.onHide():i)&&(t.remove(),y(document).off(".w2overlay"+g),clearInterval(t.data("timer"))):t.removeData("keepOpen")))}function w(){var e=y("#w2ui-overlay"+g),t=e.find(" > div"),i=y("#w2ui-overlay"+g+" div.w2ui-menu"),n={};if(0<i.length&&(i.css("overflow-y","hidden"),n.scrollTop=i.scrollTop(),n.scrollLeft=i.scrollLeft()),0<e.length){t.height("auto").width("auto");var s=!1,o=t.height(),a=t.width();(a=f.width&&f.width<a?f.width:a)<30&&(a=30),f.tmp.contentHeight&&(o=parseInt(f.tmp.contentHeight),t.height(o),setTimeout(function(){var e=t.find("div.w2ui-menu");o>e.height()&&t.find("div.w2ui-menu").css("overflow-y","hidden")},1),setTimeout(function(){var e=t.find("div.w2ui-menu");"auto"!==e.css("overflow-y")&&e.css("overflow-y","auto")},10)),f.tmp.contentWidth&&"both"!==f.align?(a=parseInt(f.tmp.contentWidth),t.width(a),setTimeout(function(){a>t.find("div.w2ui-menu > table").width()&&t.find("div.w2ui-menu > table").css("overflow-x","hidden")},1),setTimeout(function(){t.find("div.w2ui-menu > table").css("overflow-x","auto")},10)):t.find("div.w2ui-menu").css("width","100%");var r=f.left,l=f.width,d=f.tipLeft;switch(f.align){case"both":r=17,0===f.width&&(f.width=w2utils.getSize(y(m),"width")),f.maxWidth&&f.width>f.maxWidth&&(f.width=f.maxWidth);break;case"left":r=17;break;case"right":r=w2utils.getSize(y(m),"width")-a+10,d=a-40}var u="auto"!==(l=30!==a||l?f.width||"auto":30)?(l-17)/2:(a-17)/2;u<25&&(r=25-u,d=Math.floor(u)),u=f.contextMenu?(p=f.pageX+8,h=+f.pageY,f.pageY):(p=(25<(c=m.offset()||{}).left?c.left:25)+r,h=c.top+w2utils.getSize(m,"height")+f.top+7,c.top),e.css({left:p+"px",top:h+"px","min-width":l,"min-height":f.height||"auto"});var c=t.offset()||{},p=window.innerHeight+y(document).scrollTop()-c.top-7,h=window.innerWidth+y(document).scrollLeft()-c.left-7;f.contextMenu&&(p=window.innerHeight+y(document).scrollTop()-f.pageY-15,h=window.innerWidth+y(document).scrollLeft()-f.pageX),(-50<p&&p<210||!0===f.openAbove)&&!1!==f.openAbove?(l=f.contextMenu?(p=f.pageY-7,5):(p=c.top-y(document).scrollTop()-7,24),(p=f.maxHeight&&p>f.maxHeight?f.maxHeight:p)<o&&(s=!0,t.height(p).width(a).css({"overflow-y":"auto"}),o=p),e.addClass("bottom-arrow"),e.css("top",u-o-l+f.top+"px")):((p=f.maxHeight&&p>f.maxHeight?f.maxHeight:p)<o&&(s=!0,t.height(p).width(a).css({"overflow-y":"auto"})),e.addClass("top-arrow")),e.find(">style").html("#w2ui-overlay"+g+":before { margin-left: "+parseInt(d)+"px; }#w2ui-overlay"+g+":after { margin-left: "+parseInt(d)+"px; }"),a=t.width(),h=window.innerWidth+y(document).scrollLeft()-c.left-7,(h=f.maxWidth&&h>f.maxWidth?f.maxWidth:h)<a&&"both"!==f.align&&(f.align="right",setTimeout(function(){w()},1)),(f.contextMenu||f.noTip)&&e.find(">style").html("#w2ui-overlay"+g+":before { display: none; }#w2ui-overlay"+g+":after { display: none; }"),s&&"both"!==f.align&&t.width(a+w2utils.scrollBarSize()+2)}0<i.length&&(i.css("overflow-y","auto"),i.scrollTop(n.scrollTop),i.scrollLeft(n.scrollLeft))}},y.fn.w2menu=function(e,w){w&&"function"==typeof w.items&&(w.items=w.items());var t,l=this,d="";if("refresh"===e)y.fn.w2menuOptions&&y.fn.w2menuOptions.name&&(d="-"+y.fn.w2menuOptions.name),w.name&&(d="-"+w.name),0<y("#w2ui-overlay"+d).length?(w=y.extend(y.fn.w2menuOptions,w),a=y("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(),y("#w2ui-overlay"+d+" div.w2ui-menu").html(v()),y("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(a),u()):y(this).w2menu(w);else if("refresh-index"===e){var i,n,s=y("#w2ui-overlay"+d+" div.w2ui-menu"),o=s.find("tr[index="+w.index+"]"),a=s.scrollTop();s.find("tr.w2ui-selected").removeClass("w2ui-selected"),o.addClass("w2ui-selected"),0<o.length&&(i=o[0].offsetTop-5,n=s.height(),s.scrollTop(a),(i<a||i+o.height()>a+n)&&s.animate({scrollTop:i-(n-2*o.height())/2},200,"linear")),u()}else{1===arguments.length?w=e:w.items=e,"object"!=typeof w&&(w={}),w=y.extend({},{type:"normal",index:null,items:[],render:null,msgNoItems:"No items",onSelect:null,hideOnRemove:!1,tmp:{}},w),(y.fn.w2menuOptions=w).name&&(d="-"+w.name),"function"==typeof w.select&&"function"!=typeof w.onSelect&&(w.onSelect=w.select),"function"==typeof w.remove&&"function"!=typeof w.onRemove&&(w.onRemove=w.remove),"function"==typeof w.onRender&&"function"!=typeof w.render&&(w.render=w.onRender),y.fn.w2menuClick=function(e,t,i){var n=!1,s=y(e.target).closest("tr");(e.shiftKey||e.metaKey||e.ctrlKey)&&(n=!0),items=(null==i?w:w.items[i]).items,y(e.target).hasClass("remove")?("function"==typeof w.onRemove&&w.onRemove({index:t,parentIndex:i,item:items[t],keepOpen:n,originalEvent:e}),n=!w.hideOnRemove,y(e.target).closest("tr").remove(),u()):s.hasClass("has-sub-menu")?(n=!0,s.hasClass("expanded")?(items[t].expanded=!1,s.removeClass("expanded").addClass("collapsed").next().hide()):(items[t].expanded=!0,s.addClass("expanded").removeClass("collapsed").next().show()),u()):"function"==typeof w.onSelect&&(s=items,null!=(s="function"==typeof items?items(w.items[i]):s)[t].keepOpen&&(n=s[t].keepOpen),w.onSelect({index:t,parentIndex:i,item:s[t],keepOpen:n,originalEvent:e})),null!=items[t]&&!0===items[t].keepOpen||((t=y("#w2ui-overlay"+d)).removeData("keepOpen"),0<t.length&&"function"==typeof t[0].hide&&!n&&t[0].hide())},y.fn.w2menuDown=function(e,t,i){var n=y(e.target).closest("tr"),s=y(n.get(0)).find(".w2ui-icon"),o=(null==i?w:w.items[i]).items,a=o[t];"check"!==w.type&&"radio"!==w.type||!1===a.group||y(e.target).hasClass("remove")||y(e.target).closest("tr").hasClass("has-sub-menu")||(a.checked=!a.checked,a.checked?("radio"===w.type&&s.parents("table").find(".w2ui-icon").removeClass("w2ui-icon-check").addClass("w2ui-icon-empty"),"check"===w.type&&null!=a.group&&o.forEach(function(e,t){e.id!=a.id&&e.group===a.group&&e.checked&&(s.closest("table").find("tr[index="+t+"] .w2ui-icon").removeClass("w2ui-icon-check").addClass("w2ui-icon-empty"),o[t].checked=!1)}),s.removeClass("w2ui-icon-empty").addClass("w2ui-icon-check")):"check"===w.type&&null==a.group&&!1!==a.group&&s.removeClass("w2ui-icon-check").addClass("w2ui-icon-empty")),n.parent().find("tr").removeClass("w2ui-selected"),n.addClass("w2ui-selected")};o="";if(w.search){o+='<div style="position: absolute; top: 0px; height: 40px; left: 0px; right: 0px; border-bottom: 1px solid silver; background-color: #ECECEC; padding: 8px 5px;">    <div class="w2ui-icon icon-search" style="position: absolute; margin-top: 4px; margin-left: 6px; width: 11px; background-position: left !important;"></div>    <input id="menu-search" type="text" style="width: 100%; outline: none; padding-left: 20px;" onclick="event.stopPropagation();"/></div>',w.style+=";background-color: #ECECEC";for(var r=w.index=0;r<w.items.length;r++)w.items[r].hidden=!1}o+=(w.topHTML||"")+'<div class="w2ui-menu" style="top: '+(w.search?40:0)+"px;"+(w.menuStyle||"")+'">'+v()+"</div>",t=y(this).w2overlay(o,w),setTimeout(function(){if(y("#w2ui-overlay"+d+" #menu-search").on("keyup",c).on("keydown",function(e){9===e.keyCode&&(e.stopPropagation(),e.preventDefault())}),w.search){if(-1!==["text","password"].indexOf(y(l)[0].type)||"TEXTAREA"===y(l)[0].tagName.toUpperCase())return;y("#w2ui-overlay"+d+" #menu-search").focus()}u()},250),u();o=y("#w2ui-overlay"+d);0<o.length&&(o[0].mresize=u,o[0].change=c)}return t;function u(){setTimeout(function(){y("#w2ui-overlay"+d+" tr.w2ui-selected").removeClass("w2ui-selected");var e,t,i=y("#w2ui-overlay"+d+" tr[index="+w.index+"]"),n=y("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop();i.addClass("w2ui-selected"),w.tmp&&(w.tmp.contentHeight=y("#w2ui-overlay"+d+" table").height()+(w.search?50:10)+(parseInt(y("#w2ui-overlay"+d+" .w2ui-menu").css("top"))||0)+(parseInt(y("#w2ui-overlay"+d+" .w2ui-menu").css("bottom"))||0),w.tmp.contentWidth=y("#w2ui-overlay"+d+" table").width()),0<y("#w2ui-overlay"+d).length&&y("#w2ui-overlay"+d)[0].resize(),0<i.length&&(e=i[0].offsetTop-5,t=y("#w2ui-overlay"+d+" div.w2ui-menu").height(),y("#w2ui-overlay"+d+" div.w2ui-menu").scrollTop(n),(e<n||e+i.height()>n+t)&&y("#w2ui-overlay"+d+" div.w2ui-menu").animate({scrollTop:e-(t-2*i.height())/2},200,"linear"))},1)}function c(e){var t=this.value,i=!1;switch(e.keyCode){case 13:y("#w2ui-overlay"+d).remove(),y.fn.w2menuClick(e,w.index);break;case 9:case 27:y("#w2ui-overlay"+d).remove(),y.fn.w2menuClick(e,-1);break;case 38:for(w.index=w2utils.isInt(w.index)?parseInt(w.index):0,w.index--;0<w.index&&w.items[w.index].hidden;)w.index--;if(0===w.index&&w.items[w.index].hidden)for(;w.items[w.index]&&w.items[w.index].hidden;)w.index++;w.index<0&&(w.index=0),i=!0;break;case 40:for(w.index=w2utils.isInt(w.index)?parseInt(w.index):0,w.index++;w.index<w.items.length-1&&w.items[w.index].hidden;)w.index++;if(w.index===w.items.length-1&&w.items[w.index].hidden)for(;w.items[w.index]&&w.items[w.index].hidden;)w.index--;w.index>=w.items.length&&(w.index=w.items.length-1),i=!0}if(!i){for(var n=0,s=0;s<w.items.length;s++){var o=w.items[s],a="",r="";-1!==["is","begins with"].indexOf(w.match)&&(a="^"),-1!==["is","ends with"].indexOf(w.match)&&(r="$");try{new RegExp(a+t+r,"i").test(o.text)||"..."===o.text?o.hidden=!1:o.hidden=!0}catch(e){}"enum"===l.type&&-1!==y.inArray(o.id,ids)&&(o.hidden=!0),!0!==o.hidden&&n++}for(w.index=0;w.index<w.items.length-1&&w.items[w.index].hidden;)w.index++;n<=0&&(w.index=-1)}y(l).w2menu("refresh",w),u()}function v(e,t,i,n){if(w.spinner)return'<table><tbody><tr><td style="padding: 5px 10px 13px 10px; text-align: center">    <div class="w2ui-spinner" style="width: 18px; height: 18px; position: relative; top: 5px;"></div>     <div style="display: inline-block; padding: 3px; color: #999;">'+w2utils.lang("Loading...")+"</div></td></tr></tbody></table>";var s=0,o='<table cellspacing="0" cellpadding="0" class="'+(t?" sub-menu":"")+'"><tbody>',a=null,r=null;null==e&&(e=w.items),Array.isArray(e)||(e=[]);for(var l=0;l<e.length;l++){var d,u,c,p,h,f,m,g=e[l];"string"==typeof g?g={id:g,text:g}:(null!=g.text&&null==g.id&&(g.id=g.text),null==g.text&&null!=g.id&&(g.text=g.id),null!=g.caption&&(g.text=g.caption),null==(a=g.img)&&(a=null),null==(r=g.icon)&&(r=null)),-1==["radio","check"].indexOf(w.type)||Array.isArray(g.items)||!1===g.group||(r=!0===g.checked?"w2ui-icon-check":"w2ui-icon-empty"),!0!==g.hidden&&(d="",m=g.text,u="","function"==typeof(m="function"==typeof w.render?w.render(g,w):m)&&(m=m(g,w)),a&&(d='<td class="menu-icon"><div class="w2ui-tb-image w2ui-icon '+a+'"></div></td>'),r&&(d='<td class="menu-icon" align="center"><span class="w2ui-icon '+r+'"></span></td>'),"break"!==g.type&&null!=m&&""!==m&&"--"!=String(m).substr(0,2)?(c=s%2==0?"w2ui-item-even":"w2ui-item-odd",!0!==w.altRows&&(c=""),p=1,""===d&&p++,null==g.count&&null==g.hotkey&&!0!==g.remove&&null==g.items&&p++,null==g.tooltip&&null!=g.hint&&(g.tooltip=g.hint),!(h="")===g.remove?h='<span class="remove">X</span>':null!=g.items?(f=[],"function"==typeof g.items?f=g.items(g):Array.isArray(g.items)&&(f=g.items),h="<span></span>",u='<tr style="'+(g.expanded?"":"display: none")+'">     <td colspan="3">'+v(f,!0,g.expanded,l)+"</td><tr>"):(null!=g.count&&(h+="<span>"+g.count+"</span>"),null!=g.hotkey&&(h+='<span class="hotkey">'+g.hotkey+"</span>")),o+='<tr index="'+l+'" style="'+(g.style||"")+'" '+(g.tooltip?'title="'+w2utils.lang(g.tooltip)+'"':"")+' class="'+c+(w.index===l?" w2ui-selected":"")+(!0===g.disabled?" w2ui-disabled":"")+(""!==u?" has-sub-menu"+(g.expanded?" expanded":" collapsed"):"")+'"        onmousedown="if ('+(!0===g.disabled?"true":"false")+") return;               jQuery.fn.w2menuDown(event, "+l+",  "+n+');"        onclick="event.stopPropagation();                if ('+(!0===g.disabled?"true":"false")+") return;               jQuery.fn.w2menuClick(event, "+l+",  "+n+');">'+(t?"<td></td>":"")+d+'   <td class="menu-text" colspan="'+p+'">'+w2utils.lang(m)+'</td>   <td class="menu-count">'+h+"</td></tr>"+u,s++):o+='<tr><td colspan="3" class="menu-divider '+(""!=(m=m.replace(/^-+/g,""))?"divider-text":"")+'">   <div class="line">'+m+'</div>   <div class="text">'+m+"</div></td></tr>"),e[l]=g}return 0===s&&w.msgNoItems&&(o+='<tr><td style="padding: 13px; color: #999; text-align: center">'+w.msgNoItems+"</div></td></tr>"),o+="</tbody></table>"}},y.fn.w2color=function(n,e){var o,a,s,r,l,d,u,c,p,h,f,m,t=y(this),g=t[0];function i(e){e.color;for(var t,i='<div class="w2ui-colors" onmousedown="jQuery(this).parents(\'.w2ui-overlay\').data(\'keepOpen\', true)"><div class="w2ui-color-palette"><table cellspacing="5"><tbody>',n=0;n<a.length;n++){i+="<tr>";for(var s=0;s<a[n].length;s++)t="FFFFFF"===a[n][s]?";border: 1px solid #efefef":"",i+='<td>    <div class="w2ui-color '+(""===a[n][s]?"w2ui-no-color":"")+'" style="background-color: #'+a[n][s]+t+';"        name="'+a[n][s]+'" index="'+n+":"+s+'">'+(e.color==a[n][s]?"&#149;":"&#160;")+"    </div></td>",e.color==a[n][s]&&(o=[n,s]);i+="</tr>",n<2&&(i+='<tr><td style="height: 8px" colspan="8"></td></tr>')}return i+="</tbody></table></div>",i+='<div class="w2ui-color-advanced" style="display: none">   <div class="color-info">       <div class="color-preview-bg"><div class="color-preview"></div><div class="color-original"></div></div>       <div class="color-part">           <span>H</span> <input name="h" maxlength="3" max="360" tabindex="101">           <span>R</span> <input name="r" maxlength="3" max="255" tabindex="104">       </div>       <div class="color-part">           <span>S</span> <input name="s" maxlength="3" max="100" tabindex="102">           <span>G</span> <input name="g" maxlength="3" max="255" tabindex="105">       </div>       <div class="color-part">           <span>V</span> <input name="v" maxlength="3" max="100" tabindex="103">           <span>B</span> <input name="b" maxlength="3" max="255" tabindex="106">       </div>       <div class="color-part" style="margin: 30px 0px 0px 2px">           <span style="width: 40px">Opacity</span>            <input name="a" maxlength="5" max="1" style="width: 32px !important" tabindex="107">       </div>   </div>   <div class="palette" name="palette">       <div class="palette-bg"></div>       <div class="value1 move-x move-y"></div>   </div>   <div class="rainbow" name="rainbow">       <div class="value2 move-x"></div>   </div>   <div class="alpha" name="alpha">       <div class="alpha-bg"></div>       <div class="value2 move-x"></div>   </div></div>',i+="<div class=\"w2ui-color-tabs\">   <div class=\"w2ui-color-tab selected\" onclick=\"jQuery(this).addClass('selected').next().removeClass('selected').parents('.w2ui-overlay').find('.w2ui-color-advanced').hide().parent().find('.w2ui-color-palette').show(); jQuery.fn._colorAdvanced = false; jQuery('#w2ui-overlay')[0].resize()\"><span class=\"w2ui-icon w2ui-icon-colors\"></span></div>   <div class=\"w2ui-color-tab\" onclick=\"jQuery(this).addClass('selected').prev().removeClass('selected').parents('.w2ui-overlay').find('.w2ui-color-advanced').show().parent().find('.w2ui-color-palette').hide(); jQuery.fn._colorAdvanced = true; jQuery('#w2ui-overlay')[0].resize()\"><span class=\"w2ui-icon w2ui-icon-settings\"></span></div>   <div style=\"padding: 8px; text-align: right;\">"+("string"==typeof e.html?e.html:"")+'</div></div></div><div style="clear: both; height: 0"></div>'}t.data("skipInit")?t.removeData("skipInit"):(o=[-1,-1],null==y.fn.w2colorPalette&&(y.fn.w2colorPalette=[["000000","333333","555555","777777","888888","999999","AAAAAA","CCCCCC","DDDDDD","EEEEEE","F7F7F7","FFFFFF"],["FF011B","FF9838","FFC300","FFFD59","86FF14","14FF7A","2EFFFC","2693FF","006CE7","9B24F4","FF21F5","FF0099"],["FFEAEA","FCEFE1","FCF4DC","FFFECF","EBFFD9","D9FFE9","E0FFFF","E8F4FF","ECF4FC","EAE6F4","FFF5FE","FCF0F7"],["F4CCCC","FCE5CD","FFF1C2","FFFDA1","D5FCB1","B5F7D0","BFFFFF","D6ECFF","CFE2F3","D9D1E9","FFE3FD","FFD9F0"],["EA9899","F9CB9C","FFE48C","F7F56F","B9F77E","84F0B1","83F7F7","B5DAFF","9FC5E8","B4A7D6","FAB9F6","FFADDE"],["E06666","F6B26B","DEB737","E0DE51","8FDB48","52D189","4EDEDB","76ACE3","6FA8DC","8E7CC3","E07EDA","F26DBD"],["CC0814","E69138","AB8816","B5B20E","6BAB30","27A85F","1BA8A6","3C81C7","3D85C6","674EA7","A14F9D","BF4990"],["99050C","B45F17","80650E","737103","395E14","10783D","13615E","094785","0A5394","351C75","780172","782C5A"]]),a=y.fn.w2colorPalette,null==(n="string"==typeof n?{color:n,transparent:!0}:n).onSelect&&null!=e&&(n.onSelect=e),n.transparent&&"333333"==a[0][1]&&(a[0].splice(1,1),a[0].push("")),n.transparent||"333333"==a[0][1]||(a[0].splice(1,0,"333333"),a[0].pop()),n.color&&(n.color=String(n.color).toUpperCase()),"string"==typeof n.color&&"#"===n.color.substr(0,1)&&(n.color=n.color.substr(1)),null==n.fireChange&&(n.fireChange=!0),0===y("#w2ui-overlay").length?y(g).w2overlay(i(n),n):(y("#w2ui-overlay .w2ui-colors").parent().html(i(n)),y("#w2ui-overlay").show()),y("#w2ui-overlay .w2ui-color").off(".w2color").on("mousedown.w2color",function(e){var t=y(e.originalEvent.target).attr("name");o=y(e.originalEvent.target).attr("index").split(":"),"INPUT"===g.tagName.toUpperCase()?(n.fireChange&&y(g).change(),y(g).next().find(">div").css("background-color",t)):y(g).data("_color",t),"function"==typeof n.onSelect&&n.onSelect(t)}).on("mouseup.w2color",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)}),y("#w2ui-overlay .color-original").off(".w2color").on("click.w2color",function(e){e=w2utils.parseColor(y(e.target).css("background-color"));null!=e&&(l=e,r=w2utils.rgb2hsv(l),d(r),u(),c())}),y("#w2ui-overlay input").off(".w2color").on("mousedown.w2color",function(e){y("#w2ui-overlay").data("keepOpen",!0),setTimeout(function(){y("#w2ui-overlay").data("keepOpen",!0)},10),e.stopPropagation()}).on("change.w2color",function(){var e=y(this),t=parseFloat(e.val()),i=parseFloat(e.attr("max"));isNaN(t)&&(t=0),1<i&&(t=parseInt(t)),0<i&&i<t&&(e.val(i),t=i),t<0&&(e.val(0),t=0);i=e.attr("name"),e={};-1!==["r","g","b","a"].indexOf(i)?(l[i]=t,r=w2utils.rgb2hsv(l)):-1!==["h","s","v"].indexOf(i)&&(e[i]=t),d(e),u(),c()}),null==(l=w2utils.parseColor(n.color))&&(l={r:140,g:150,b:160,a:1},r=w2utils.rgb2hsv(l)),r=w2utils.rgb2hsv(l),d=function(e,t){null!=e.h&&(r.h=e.h),null!=e.s&&(r.s=e.s),null!=e.v&&(r.v=e.v),null!=e.a&&(l.a=e.a,r.a=e.a);var e="rgba("+(l=w2utils.hsv2rgb(r)).r+","+l.g+","+l.b+","+l.a+")",i=[Number(l.r).toString(16).toUpperCase(),Number(l.g).toString(16).toUpperCase(),Number(l.b).toString(16).toUpperCase(),Math.round(255*Number(l.a)).toString(16).toUpperCase()];i.forEach(function(e,t){1===e.length&&(i[t]="0"+e)}),e=i[0]+i[1]+i[2]+i[3],1===l.a&&(e=i[0]+i[1]+i[2]),y("#w2ui-overlay .color-preview").css("background-color","#"+e),y("#w2ui-overlay input").each(function(e,t){t.name&&(null!=l[t.name]&&(t.value=l[t.name]),null!=r[t.name]&&(t.value=r[t.name]),"a"===t.name&&(t.value=l.a))}),t?y("#w2ui-overlay .color-original").css("background-color","#"+e):("INPUT"===g.tagName.toUpperCase()?(y(g).val(e).data("skipInit",!0),n.fireChange&&y(g).change(),y(g).next().find(">div").css("background-color","#"+e)):y(g).data("_color",e),"function"==typeof n.onSelect&&n.onSelect(e))},u=function(){var e=y("#w2ui-overlay .palette .value1"),t=y("#w2ui-overlay .rainbow .value2"),i=y("#w2ui-overlay .alpha .value2"),n=parseInt(e.width())/2,s=parseInt(t.width())/2;e.css({left:150*r.s/100-n,top:125*(100-r.v)/100-n}),t.css("left",r.h/2.4-s),i.css("left",150*l.a-s)},c=function(){var e=w2utils.hsv2rgb(r.h,100,100),e=e.r+","+e.g+","+e.b;y("#w2ui-overlay .palette").css("background-image","linear-gradient(90deg, rgba("+e+",0) 0%, rgba("+e+",1) 100%)")},e=function(e){var t=y(this).find(".value1, .value2"),i=parseInt(t.width())/2;t.hasClass("move-x")&&t.css({left:e.offsetX-i+"px"}),t.hasClass("move-y")&&t.css({top:e.offsetY-i+"px"}),s={$el:t,x:e.pageX,y:e.pageY,width:t.parent().width(),height:t.parent().height(),left:parseInt(t.css("left")),top:parseInt(t.css("top"))},h(e),y("body").off(".w2color").on(m,h).on(f,p)},p=function(e){y("body").off(".w2color")},h=function(e){var t=s.$el,i=e.pageX-s.x,n=e.pageY-s.y,e=s.left+i,i=s.top+n,n=parseInt(t.width())/2;i<-n&&(i=-n),(e=e<-n?-n:e)>s.width-n&&(e=s.width-n),i>s.height-n&&(i=s.height-n),t.hasClass("move-x")&&t.css({left:e+"px"}),t.hasClass("move-y")&&t.css({top:i+"px"});e=t.parent().attr("name"),i=parseInt(t.css("left"))+n,n=parseInt(t.css("top"))+n;"palette"===e&&d({s:Math.round(i/s.width*100),v:Math.round(100-n/s.height*100)}),"rainbow"===e&&(n=Math.round(2.4*i),d({h:n}),c()),"alpha"===e&&d({a:parseFloat(Number(i/150).toFixed(2))})},!0!==y.fn._colorAdvanced&&!0!==n.advanced||(y("#w2ui-overlay .w2ui-color-tabs :nth-child(2)").click(),y("#w2ui-overlay").removeData("keepOpen")),d({},!0),c(),u(),f="mouseup.w2color",m="mousemove.w2color",w2utils.isIOS&&(f="touchend.w2color",m="touchmove.w2color  "),y("#w2ui-overlay .palette").off(".w2color").on("mousedown.w2color",e),y("#w2ui-overlay .rainbow").off(".w2color").on("mousedown.w2color",e),y("#w2ui-overlay .alpha").off(".w2color").on("mousedown.w2color",e),g.nav=function(e){switch(e){case"up":o[0]--;break;case"down":o[0]++;break;case"right":o[1]++;break;case"left":o[1]--}return o[0]<0&&(o[0]=0),o[0]>a.length-2&&(o[0]=a.length-2),o[1]<0&&(o[1]=0),o[1]>a[0].length-1&&(o[1]=a[0].length-1),color=a[o[0]][o[1]],y(g).data("_color",color),color})}}(jQuery),function(y){function s(e){this.el=null,this.helpers={},this.type=e.type||"text",this.options=y.extend(!0,{},e),this.onSearch=e.onSearch||null,this.onRequest=e.onRequest||null,this.onLoad=e.onLoad||null,this.onError=e.onError||null,this.onClick=e.onClick||null,this.onAdd=e.onAdd||null,this.onNew=e.onNew||null,this.onRemove=e.onRemove||null,this.onMouseOver=e.onMouseOver||null,this.onMouseOut=e.onMouseOut||null,this.onIconClick=e.onIconClick||null,this.onScroll=e.onScroll||null,this.tmp={},delete this.options.type,delete this.options.onSearch,delete this.options.onRequest,delete this.options.onLoad,delete this.options.onError,delete this.options.onClick,delete this.options.onMouseOver,delete this.options.onMouseOut,delete this.options.onIconClick,delete this.options.onScroll,y.extend(!0,this,w2obj.field)}y.fn.w2field=function(n,e){if(0!==this.length)return 0===arguments.length?y(this).data("w2field"):((n="string"==typeof(n="string"==typeof n&&"object"==typeof e?y.extend(!0,{},e,{type:n}):n)&&null==e?{type:n}:n)&&(n.type=String(n.type).toLowerCase()),this.each(function(e,t){var i=y(t).data("w2field");return null==i?(i=new s(n),y.extend(i,{handlers:[]}),t&&(i.el=y(t)[0]),i.init(),y(t).data("w2field",i),i):(i.clear(),"clear"===n.type?void 0:(i=new s(n),y.extend(i,{handlers:[]}),t&&(i.el=y(t)[0]),i.init(),y(t).data("w2field",i),i))}));var t=s.prototype;return t[n]?t[n].apply(t,Array.prototype.slice.call(arguments,1)):void 0},s.prototype={custom:{},addType:function(e,t){return e=String(e).toLowerCase(),this.custom[e]=t,!0},removeType:function(e){return e=String(e).toLowerCase(),!!this.custom[e]&&(delete this.custom[e],!0)},init:function(){var e,t=this,i=this.options;if("function"!=typeof this.custom[this.type])if(-1!=["INPUT","TEXTAREA"].indexOf(this.el.tagName.toUpperCase())){switch(this.type){case"text":case"int":case"float":case"money":case"currency":case"percent":case"alphanumeric":case"bin":case"hex":e={min:null,max:null,step:1,autoFormat:!0,currencyPrefix:w2utils.settings.currencyPrefix,currencySuffix:w2utils.settings.currencySuffix,currencyPrecision:w2utils.settings.currencyPrecision,decimalSymbol:w2utils.settings.decimalSymbol,groupSymbol:w2utils.settings.groupSymbol,arrows:!1,keyboard:!0,precision:null,silent:!0,prefix:"",suffix:""},this.options=y.extend(!0,{},e,i),(i=this.options).numberRE=new RegExp("["+i.groupSymbol+"]","g"),i.moneyRE=new RegExp("["+i.currencyPrefix+i.currencySuffix+i.groupSymbol+"]","g"),i.percentRE=new RegExp("["+i.groupSymbol+"%]","g"),-1!==["text","alphanumeric","hex","bin"].indexOf(this.type)&&(i.arrows=!1,i.keyboard=!1),this.addPrefix(),this.addSuffix();break;case"color":e={prefix:"",suffix:'<div style="width: '+(parseInt(y(this.el).css("font-size"))||12)+'px">&#160;</div>',arrows:!1,keyboard:!1,advanced:null,transparent:!0},y.extend(i,e),this.addPrefix(),this.addSuffix(),""!==y(this.el).val()&&setTimeout(function(){t.change()},1);break;case"date":e={format:w2utils.settings.dateFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:{},colored:{},blockWeekDays:null},this.options=y.extend(!0,{},e,i),i=this.options,null==y(this.el).attr("placeholder")&&y(this.el).attr("placeholder",i.format);break;case"time":e={format:w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",noMinutes:!1},this.options=y.extend(!0,{},e,i),i=this.options,null==y(this.el).attr("placeholder")&&y(this.el).attr("placeholder",i.format);break;case"datetime":e={format:w2utils.settings.dateFormat+" | "+w2utils.settings.timeFormat,keyboard:!0,silent:!0,start:"",end:"",blocked:[],colored:{},placeholder:null,btn_now:!0,noMinutes:!1},this.options=y.extend(!0,{},e,i),i=this.options,null==y(this.el).attr("placeholder")&&y(this.el).attr("placeholder",i.placeholder||i.format);break;case"list":case"combo":if(e={items:[],selected:{},url:null,recId:null,recText:null,method:null,interval:350,postData:{},minLength:1,cacheMax:250,maxDropHeight:350,maxDropWidth:null,match:"begins",silent:!0,icon:null,iconStyle:"",align:"both",altRows:!0,onSearch:null,onRequest:null,onLoad:null,onError:null,onIconClick:null,renderDrop:null,compare:null,filter:!0,prefix:"",suffix:"",openOnFocus:!1,markSearch:!1},"function"==typeof i.items&&(i._items_fun=i.items),i.items=w2obj.field.prototype.normMenu.call(this,i.items),"list"===this.type){if(e.openOnFocus=!0,y(this.el).addClass("w2ui-select"),!y.isPlainObject(i.selected)&&Array.isArray(i.items))for(var n=0;n<i.items.length;n++){var s=i.items[n];if(s&&s.id===i.selected){i.selected=y.extend(!0,{},s);break}}this.watchSize()}i=y.extend({},e,i),this.options=i,y.isPlainObject(i.selected)||(i.selected={}),y(this.el).data("selected",i.selected),i.url&&(i.items=[],this.request(0)),"list"===this.type&&this.addFocus(),this.addPrefix(),this.addSuffix(),setTimeout(function(){t.refresh()},10),y(this.el).attr("autocapitalize","off").attr("autocomplete","off").attr("autocorrect","off").attr("spellcheck","false"),null!=i.selected.text&&y(this.el).val(i.selected.text);break;case"enum":e={items:[],selected:[],max:0,url:null,recId:null,recText:null,interval:350,method:null,postData:{},minLength:1,cacheMax:250,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,match:"contains",silent:!0,align:"both",altRows:!0,openOnFocus:!1,markSearch:!0,renderDrop:null,renderItem:null,compare:null,filter:!0,style:"",onSearch:null,onRequest:null,onLoad:null,onError:null,onClick:null,onAdd:null,onNew:null,onRemove:null,onMouseOver:null,onMouseOut:null,onScroll:null},"function"==typeof(i=y.extend({},e,i,{suffix:""})).items&&(i._items_fun=i.items),i.items=w2obj.field.prototype.normMenu.call(this,i.items),i.selected=w2obj.field.prototype.normMenu.call(this,i.selected),this.options=i,y.isArray(i.selected)||(i.selected=[]),y(this.el).data("selected",i.selected),i.url&&(i.items=[],this.request(0)),this.addSuffix(),this.addMulti(),this.watchSize();break;case"file":e={selected:[],max:0,maxSize:0,maxFileSize:0,maxWidth:250,maxHeight:350,maxDropHeight:350,maxDropWidth:null,readContent:!0,silent:!0,align:"both",altRows:!0,renderItem:null,style:"",onClick:null,onAdd:null,onRemove:null,onMouseOver:null,onMouseOut:null},i=y.extend({},e,i),this.options=i,y.isArray(i.selected)||(i.selected=[]),y(this.el).data("selected",i.selected),null==y(this.el).attr("placeholder")&&y(this.el).attr("placeholder",w2utils.lang("Attach files by dragging and dropping or Click to Select")),this.addMulti(),this.watchSize()}this.tmp={onChange:function(e){t.change.call(t,e)},onClick:function(e){t.click.call(t,e)},onFocus:function(e){t.focus.call(t,e)},onBlur:function(e){t.blur.call(t,e)},onKeydown:function(e){t.keyDown.call(t,e)},onKeyup:function(e){t.keyUp.call(t,e)},onKeypress:function(e){t.keyPress.call(t,e)}},y(this.el).addClass("w2field w2ui-input").data("w2field",this).on("change.w2field",this.tmp.onChange).on("click.w2field",this.tmp.onClick).on("focus.w2field",this.tmp.onFocus).on("blur.w2field",this.tmp.onBlur).on("keydown.w2field",this.tmp.onKeydown).on("keyup.w2field",this.tmp.onKeyup).on("keypress.w2field",this.tmp.onKeypress).css(w2utils.cssPrefix("box-sizing","border-box")),this.change(y.Event("change"))}else console.log("ERROR: w2field could only be applied to INPUT or TEXTAREA.",this.el);else this.custom[this.type].call(this,i)},watchSize:function(){var e=this,t=y(e.el).data("tmp")||{};t.sizeTimer=setInterval(function(){0<y(e.el).parents("body").length?e.resize():clearInterval(t.sizeTimer)},200),y(e.el).data("tmp",t)},get:function(){var e=-1!==["list","enum","file"].indexOf(this.type)?y(this.el).data("selected"):y(this.el).val();return e},set:function(e,t){-1!==["list","enum","file"].indexOf(this.type)?("list"!==this.type&&t?(null==y(this.el).data("selected")&&y(this.el).data("selected",[]),y(this.el).data("selected").push(e),y(this.el).change()):(t="enum"===this.type?[e]:e,y(this.el).data("selected",t).change()),this.refresh()):y(this.el).val(e)},setIndex:function(e,t){if(-1!==["list","enum"].indexOf(this.type)){var i=this.options.items;if(i&&i[e])return"list"!==this.type&&t?(null==y(this.el).data("selected")&&y(this.el).data("selected",[]),y(this.el).data("selected").push(i[e]),y(this.el).change()):(e="enum"===this.type?[i[e]]:i[e],y(this.el).data("selected",e).change()),this.refresh(),!0}return!1},clear:function(){var e=this.options;-1!==["money","currency"].indexOf(this.type)&&y(this.el).val(y(this.el).val().replace(e.moneyRE,"")),"percent"===this.type&&y(this.el).val(y(this.el).val().replace(/%/g,"")),"list"===this.type&&y(this.el).removeClass("w2ui-select"),this.type="clear";e=y(this.el).data("tmp");if(this.tmp){for(var t in null!=e&&(y(this.el).height("auto"),e&&e["old-padding-left"]&&y(this.el).css("padding-left",e["old-padding-left"]),e&&e["old-padding-right"]&&y(this.el).css("padding-right",e["old-padding-right"]),e&&e["old-background-color"]&&y(this.el).css("background-color",e["old-background-color"]),e&&e["old-border-color"]&&y(this.el).css("border-color",e["old-border-color"]),clearInterval(e.sizeTimer)),y(this.el).val(this.clean(y(this.el).val())).removeClass("w2field").removeData().off(".w2field"),this.helpers)y(this.helpers[t]).remove();this.helpers={}}},refresh:function(){var a=this,i=this.options,r=y(this.el).data("selected"),e=(new Date).getTime();if(-1!==["list"].indexOf(this.type)&&(y(a.el).parent().css("white-space","nowrap"),a.helpers.prefix&&a.helpers.prefix.hide(),setTimeout(function(){var t;a.helpers.focus&&(!y.isEmptyObject(r)&&i.icon?i.prefix='<span class="w2ui-icon '+i.icon+'"style="cursor: pointer; font-size: 14px; display: inline-block; margin-top: -1px; color: #7F98AD;'+i.iconStyle+'"></span>':i.prefix="",a.addPrefix(),t=a.helpers.focus.find("input"),""===y(t).val()?(y(t).css("text-indent","-9999em").prev().css("opacity",0),y(a.el).val(r&&null!=r.text?w2utils.lang(r.text):"")):(y(t).css("text-indent",0).prev().css("opacity",1),y(a.el).val(""),setTimeout(function(){a.helpers.prefix&&a.helpers.prefix.hide();var e="position: absolute; opacity: 0; margin: 4px 0px 0px 2px; background-position: left !important;";i.icon?(y(t).css("margin-left","17px"),y(a.helpers.focus).find(".icon-search").attr("style",e+"width: 11px !important; opacity: 1; display: block")):(y(t).css("margin-left","0px"),y(a.helpers.focus).find(".icon-search").attr("style",e+"width: 0px !important; opacity: 0; display: none"))},1)),y(a.el).prop("readonly")||y(a.el).prop("disabled")?setTimeout(function(){y(a.helpers.prefix).css("opacity","0.6"),y(a.helpers.suffix).css("opacity","0.6")},1):setTimeout(function(){y(a.helpers.prefix).css("opacity","1"),y(a.helpers.suffix).css("opacity","1")},1))},1)),-1!==["enum","file"].indexOf(this.type)){var t="";if(r)for(var n=0;n<r.length;n++){var s=r[n],o="",o="function"==typeof i.renderItem?i.renderItem(s,n,'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+n+'">&#160;&#160;</div>'):'<div class="w2ui-list-remove" title="'+w2utils.lang("Remove")+'" index="'+n+'">&#160;&#160;</div>'+("enum"===a.type?s.text:s.name+'<span class="file-size"> - '+w2utils.formatSize(s.size)+"</span>");t+='<li index="'+n+'" style="max-width: '+parseInt(i.maxWidth)+"px; "+(s.style||"")+'">'+o+"</li>"}var l=a.helpers.multi,d=l.find("ul");l.attr("style",l.attr("style")+";"+i.style),y(a.el).css("z-index","-1"),y(a.el).prop("readonly")||y(a.el).prop("disabled")?setTimeout(function(){l[0].scrollTop=0,l.addClass("w2ui-readonly").find("li").css("opacity","0.9").parent().find("li.nomouse").hide().find("input").prop("readonly",!0).parents("ul").find(".w2ui-list-remove").hide()},1):setTimeout(function(){l.removeClass("w2ui-readonly").find("li").css("opacity","1").parent().find("li.nomouse").show().find("input").prop("readonly",!1).parents("ul").find(".w2ui-list-remove").show()},1),l.find(".w2ui-enum-placeholder").remove(),d.find("li").not("li.nomouse").remove(),""!==t?d.prepend(t):null!=y(a.el).attr("placeholder")&&""===l.find("input").val()&&(u="padding-top: "+y(this.el).css("padding-top")+";padding-left: "+y(this.el).css("padding-left")+"; box-sizing: "+y(this.el).css("box-sizing")+"; line-height: "+y(this.el).css("line-height")+"; font-size: "+y(this.el).css("font-size")+"; font-family: "+y(this.el).css("font-family")+"; ",l.prepend('<div class="w2ui-enum-placeholder" style="'+u+'">'+y(a.el).attr("placeholder")+"</div>")),l.off("scroll.w2field").on("scroll.w2field",function(e){e=a.trigger({phase:"before",type:"scroll",target:a.el,originalEvent:e});!0!==e.isCancelled&&a.trigger(y.extend(e,{phase:"after"}))}).find("li").data("mouse","out").on("click",function(e){var t,i,n,s="LI"===e.target.tagName.toUpperCase()?e.target:y(e.target).parents("LI"),o=r[y(s).attr("index")];y(s).hasClass("nomouse")||(e.stopPropagation(),y(e.target).hasClass("w2ui-list-remove")?y(a.el).prop("readonly")||y(a.el).prop("disabled")||!0!==(t=a.trigger({phase:"before",type:"remove",target:a.el,originalEvent:e.originalEvent,item:o})).isCancelled&&(y().w2overlay(),r.splice(y(e.target).attr("index"),1),y(a.el).trigger("input").trigger("change"),y(e.target).parent().fadeOut("fast"),setTimeout(function(){a.refresh(),a.trigger(y.extend(t,{phase:"after"}))},300)):!0!==(t=a.trigger({phase:"before",type:"click",target:a.el,originalEvent:e.originalEvent,item:o})).isCancelled&&("file"===a.type&&(i="",/image/i.test(o.type)&&(i='<div style="padding: 3px;">    <img src="'+(o.content?"data:"+o.type+";base64,"+o.content:"")+'" style="max-width: 300px;"         onload="var w = jQuery(this).width(); var h = jQuery(this).height();             if (w < 300 & h < 300) return;             if (w >= h && w > 300) jQuery(this).width(300);            if (w < h && h > 300) jQuery(this).height(300);"        onerror="this.style.display = \'none\'"    ></div>'),n='style="padding: 3px"',i+='<div style="padding: 8px;">    <table cellpadding="2"><tbody>    <tr><td '+(e='style="padding: 3px; text-align: right; color: #777;"')+">"+w2utils.lang("Name")+":</td><td "+n+">"+o.name+"</td></tr>    <tr><td "+e+">"+w2utils.lang("Size")+":</td><td "+n+">"+w2utils.formatSize(o.size)+"</td></tr>    <tr><td "+e+">"+w2utils.lang("Type")+":</td><td "+n+'>        <span style="width: 200px; display: block-inline; overflow: hidden; text-overflow: ellipsis; white-space: nowrap="nowrap";">'+o.type+"</span>    </td></tr>    <tr><td "+e+">"+w2utils.lang("Modified")+":</td><td "+n+">"+w2utils.date(o.modified)+"</td></tr>    </tbody></table></div>",y("#w2ui-overlay").remove(),y(s).w2overlay(i)),a.trigger(y.extend(t,{phase:"after"}))))}).on("mouseover",function(e){var t="LI"===e.target.tagName.toUpperCase()?e.target:y(e.target).parents("LI");if(!y(t).hasClass("nomouse")){if("out"===y(t).data("mouse")){var i=r[y(e.target).attr("index")],i=a.trigger({phase:"before",type:"mouseOver",target:a.el,originalEvent:e.originalEvent,item:i});if(!0===i.isCancelled)return;a.trigger(y.extend(i,{phase:"after"}))}y(t).data("mouse","over")}}).on("mouseout",function(t){var i="LI"===t.target.tagName.toUpperCase()?t.target:y(t.target).parents("LI");y(i).hasClass("nomouse")||(y(i).data("mouse","leaving"),setTimeout(function(){var e;"leaving"===y(i).data("mouse")&&(y(i).data("mouse","out"),e=r[y(t.target).attr("index")],!0!==(e=a.trigger({phase:"before",type:"mouseOut",target:a.el,originalEvent:t.originalEvent,item:e})).isCancelled&&a.trigger(y.extend(e,{phase:"after"})))},0))}),y(this.el).height("auto");d=y(l).find("> div.w2ui-multi-items").height()+2*w2utils.getSize(l,"+height");(d=d<26?26:d)>i.maxHeight&&(d=i.maxHeight),0<l.length&&(l[0].scrollTop=1e3);var u=w2utils.getSize(y(this.el),"height")-2;d<u&&(d=u),y(l).css({height:d+"px",overflow:d==i.maxHeight?"auto":"hidden"}),d<i.maxHeight&&y(l).prop("scrollTop",0),y(this.el).css({height:d+0+"px"}),"enum"===a.type&&(d=a.helpers.multi.find("input")).width(8*(d.val().length+2)+"px")}return(new Date).getTime()-e},reset:function(){var e=this.type;this.clear(),this.type=e,this.init()},resize:function(){var e,t,i,n=this,s=y(n.el).width(),o=y(n.el).height();n.tmp.current_width==s&&0<o||(i=this.helpers.focus,e=this.helpers.multi,t=this.helpers.suffix,o=this.helpers.prefix,i&&i.width(y(n.el).width()),e&&(i=w2utils.getSize(n.el,"width")-parseInt(y(n.el).css("margin-left"),10)-parseInt(y(n.el).css("margin-right"),10),y(e).width(i)),t&&(n.options.suffix='<div class="arrow-down" style="margin-top: '+(parseInt(y(n.el).height())-6)/2+'px;"></div>',n.addSuffix()),o&&n.addPrefix(),n.tmp.current_width=s)},clean:function(e){if("number"==typeof e)return e;var t=this.options;return e=String(e).trim(),-1!==["int","float","money","currency","percent"].indexOf(this.type)&&("string"==typeof e&&(t.autoFormat&&-1!==["money","currency"].indexOf(this.type)&&(e=String(e).replace(t.moneyRE,"")),t.autoFormat&&"percent"===this.type&&(e=String(e).replace(t.percentRE,"")),e=(e=t.autoFormat&&-1!==["int","float"].indexOf(this.type)?String(e).replace(t.numberRE,""):e).replace(/\s+/g,"").replace(w2utils.settings.groupSymbol,"").replace(w2utils.settings.decimalSymbol,".")),parseFloat(e)==e&&(null!=t.min&&e<t.min&&(e=t.min,y(this.el).val(t.min)),null!=t.max&&e>t.max&&(e=t.max,y(this.el).val(t.max))),e=""!==e&&w2utils.isFloat(e)?Number(e):""),e},format:function(e){var t=this.options;if(t.autoFormat&&""!==e)switch(this.type){case"money":case"currency":""!==(e=w2utils.formatNumber(e,t.currencyPrecision,t.groupSymbol))&&(e=t.currencyPrefix+e+t.currencySuffix);break;case"percent":""!==(e=w2utils.formatNumber(e,t.precision,t.groupSymbol))&&(e+="%");break;case"float":e=w2utils.formatNumber(e,t.precision,t.groupSymbol);break;case"int":e=w2utils.formatNumber(e,0,t.groupSymbol)}return e},change:function(e){var t,i=this,n=i.options;if(-1!==["int","float","money","currency","percent"].indexOf(this.type)){var s=y(this.el).val(),o=this.format(this.clean(y(this.el).val()));if(""!==s&&s!=o)return y(this.el).val(o).change(),e.stopPropagation(),e.preventDefault(),!1}"color"===this.type&&("rgb"!==(t=y(this.el).val()).substr(0,3).toLowerCase()&&(t="#"+t,8!==(e=y(this.el).val().length)&&6!==e&&3!==e&&(t="")),y(this.el).next().find("div").css("background-color",t),y(this.el).hasClass("has-focus")&&!0!==y(this.el).data("skipInit")&&this.updateOverlay()),-1!==["list","enum","file"].indexOf(this.type)&&(i.refresh(),setTimeout(function(){i.refresh()},5)),-1!==["date","time","datetime"].indexOf(this.type)&&(t=parseInt(i.el.value),w2utils.isInt(i.el.value)&&3e3<t&&("time"===this.type&&y(i.el).val(w2utils.formatTime(new Date(t),n.format)).change(),"date"===this.type&&y(i.el).val(w2utils.formatDate(new Date(t),n.format)).change(),"datetime"===this.type&&y(i.el).val(w2utils.formatDateTime(new Date(t),n.format)).change()))},click:function(e){e.stopPropagation(),-1!==["list","combo","enum"].indexOf(this.type)&&(y(this.el).hasClass("has-focus")||this.focus(e)),-1!==["date","time","color","datetime"].indexOf(this.type)&&this.updateOverlay()},focus:function(e){var t=this;if(y(t.el).addClass("has-focus"),-1!==["color","date","time","datetime"].indexOf(t.type)){if(y(t.el).prop("readonly")||y(t.el).prop("disabled"))return;0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide(),setTimeout(function(){t.updateOverlay()},150)}if(-1!==["list","combo","enum"].indexOf(t.type)){if(y(t.el).prop("readonly")||y(t.el).prop("disabled"))return;0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide(),t.resize(),setTimeout(function(){"list"===t.type&&y(t.el).is(":focus")?y(t.helpers.focus).find("input").focus():(t.search(),setTimeout(function(){t.updateOverlay()},1))},1),"function"==typeof t.options._items_fun&&(t.options.items=w2obj.field.prototype.normMenu.call(this,t.options._items_fun))}"file"===t.type&&y(t.helpers.multi).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"})},blur:function(e){var t,i=this,n=i.options,s=y(i.el).val().trim(),o=y("#w2ui-overlay");y(i.el).removeClass("has-focus"),-1!==["color","date","time","list","combo","enum","datetime"].indexOf(i.type)&&(t=window.setTimeout(function(){!0!==o.data("keepOpen")&&o.hide()},0),y(".menu",o).one("focus",function(){clearTimeout(t),y(this).one("focusout",function(e){o.hide()})})),-1!==["int","float","money","currency","percent"].indexOf(i.type)&&(""===s||i.checkType(s)||(y(i.el).val("").change(),!1===n.silent&&(y(i.el).w2tag("Not a valid number"),setTimeout(function(){y(i.el).w2tag("")},3e3)))),-1!==["date","time","datetime"].indexOf(i.type)&&(""===s||i.inRange(i.el.value)?"date"!==i.type||""===s||w2utils.isDate(i.el.value,n.format)?"time"!==i.type||""===s||w2utils.isTime(i.el.value)?"datetime"!==i.type||""===s||w2utils.isDateTime(i.el.value,n.format)||(y(i.el).val("").removeData("selected").change(),!1===n.silent&&(y(i.el).w2tag("Not a valid date"),setTimeout(function(){y(i.el).w2tag("")},3e3))):(y(i.el).val("").removeData("selected").change(),!1===n.silent&&(y(i.el).w2tag("Not a valid time"),setTimeout(function(){y(i.el).w2tag("")},3e3))):(y(i.el).val("").removeData("selected").change(),!1===n.silent&&(y(i.el).w2tag("Not a valid date"),setTimeout(function(){y(i.el).w2tag("")},3e3))):(y(i.el).val("").removeData("selected").change(),!1===n.silent&&(y(i.el).w2tag("Not in range"),setTimeout(function(){y(i.el).w2tag("")},3e3)))),"enum"===i.type&&y(i.helpers.multi).find("input").val("").width(20),"file"===i.type&&y(i.helpers.multi).css({outline:"none"})},keyPress:function(e){var t=this;t.options;if(-1!==["int","float","money","currency","percent","hex","bin","color","alphanumeric"].indexOf(t.type)){if(e.metaKey||e.ctrlKey||e.altKey||e.charCode!=e.keyCode&&0<e.keyCode)return;var i=String.fromCharCode(e.charCode);if(!t.checkType(i,!0)&&13!=e.keyCode)return e.preventDefault(),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1}-1!==["date","time","datetime"].indexOf(t.type)&&9!==e.keyCode&&setTimeout(function(){t.updateOverlay()},1)},keyDown:function(e,t){var i=this,n=i.options,s=e.keyCode||t&&t.keyCode,o=!1;if(-1!==["int","float","money","currency","percent"].indexOf(i.type)){if(!n.keyboard||y(i.el).prop("readonly")||y(i.el).prop("disabled"))return;var a=parseFloat(y(i.el).val().replace(n.moneyRE,""))||0,r=n.step;switch((e.ctrlKey||e.metaKey)&&(r=10),s){case 38:if(e.shiftKey)break;y(i.el).val(a+r<=n.max||null==n.max?Number((a+r).toFixed(12)):n.max).change(),o=!0;break;case 40:if(e.shiftKey)break;y(i.el).val(a-r>=n.min||null==n.min?Number((a-r).toFixed(12)):n.min).change(),o=!0}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0))}if("date"===i.type){if(!n.keyboard||y(i.el).prop("readonly")||y(i.el).prop("disabled"))return;var l=864e5,r=1;switch((e.ctrlKey||e.metaKey)&&(r=10),(c=w2utils.isDate(y(i.el).val(),n.format,!0))||(c=new Date,l=0),s){case 38:if(e.shiftKey)break;var d=w2utils.formatDate(c.getTime()+l,n.format);10==r&&(d=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),n.format)),y(i.el).val(d).trigger("input").change(),o=!0;break;case 40:if(e.shiftKey)break;d=w2utils.formatDate(c.getTime()-l,n.format);10==r&&(d=w2utils.formatDate(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),n.format)),y(i.el).val(d).trigger("input").change(),o=!0}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length),i.updateOverlay()},0))}if("time"===i.type){if(!n.keyboard||y(i.el).prop("readonly")||y(i.el).prop("disabled"))return;var r=e.ctrlKey||e.metaKey?60:1,a=y(i.el).val(),u=i.toMin(a)||i.toMin((new Date).getHours()+":"+((new Date).getMinutes()-1));switch(s){case 38:if(e.shiftKey)break;u+=r,o=!0;break;case 40:if(e.shiftKey)break;u-=r,o=!0}o&&(y(i.el).val(i.fromMin(u)).trigger("input").change(),e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0))}if("datetime"===i.type){if(!n.keyboard||y(i.el).prop("readonly")||y(i.el).prop("disabled"))return;l=864e5,r=1;(e.ctrlKey||e.metaKey)&&(r=10);var c,p=y(i.el).val();switch((c=w2utils.isDateTime(p,this.options.format,!0))||(c=new Date,l=0),s){case 38:if(e.shiftKey)break;d=w2utils.formatDateTime(c.getTime()+l,n.format);10==r&&(d=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()+1,c.getDate()),n.format)),y(i.el).val(d).trigger("input").change(),o=!0;break;case 40:if(e.shiftKey)break;d=w2utils.formatDateTime(c.getTime()-l,n.format);10==r&&(d=w2utils.formatDateTime(new Date(c.getFullYear(),c.getMonth()-1,c.getDate()),n.format)),y(i.el).val(d).trigger("input").change(),o=!0}o&&(e.preventDefault(),setTimeout(function(){i.el.setSelectionRange(i.el.value.length,i.el.value.length),i.updateOverlay()},0))}if("color"===i.type){if(y(i.el).prop("readonly")||y(i.el).prop("disabled"))return;if((e.ctrlKey||e.metaKey)&&!e.shiftKey){var h=null;switch(s){case 38:h="up";break;case 40:h="down";break;case 39:h="right";break;case 37:h="left"}i.el.nav&&null!=h&&(p=i.el.nav(h),y(i.el).val(p).change(),e.preventDefault())}}if(-1!==["list","combo","enum"].indexOf(i.type)&&!y(i.el).prop("readonly")&&!y(i.el).prop("disabled")){var f=y(i.el).data("selected"),m=y(i.el),g=!1;switch(-1!==["list","enum"].indexOf(i.type)&&("list"===i.type&&(m=y(i.helpers.focus).find("input")),"enum"===i.type&&(m=y(i.helpers.multi).find("input")),-1==[37,38,39,40].indexOf(s)&&setTimeout(function(){i.refresh()},1),86==e.keyCode&&(e.ctrlKey||e.metaKey)&&setTimeout(function(){i.refresh(),i.search(),i.request()},50)),s){case 27:"list"===i.type&&(""!==m.val()&&m.val(""),e.stopPropagation());break;case 37:case 39:break;case 13:if(0===y("#w2ui-overlay").length)break;var w=n.items[n.index];if("enum"===i.type)if(null!=w){if(!0===(v=i.trigger({phase:"before",type:"add",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;w=v.item,f.length>=n.max&&0<n.max&&f.pop(),delete w.hidden,delete i.tmp.force_open,f.push(w),y(i.el).change(),m.val("").width(20),i.refresh(),i.trigger(y.extend(v,{phase:"after"}))}else{if(w={id:m.val(),text:m.val()},!0===(v=i.trigger({phase:"before",type:"new",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;w=v.item,"function"==typeof i.onNew&&(f.length>=n.max&&0<n.max&&f.pop(),delete i.tmp.force_open,f.push(w),y(i.el).change(),m.val("").width(20),i.refresh()),i.trigger(y.extend(v,{phase:"after"}))}else w&&y(i.el).data("selected",w).val(w.text).change(),""===y(i.el).val()&&y(i.el).data("selected")&&y(i.el).removeData("selected").val("").change(),"list"===i.type&&(m.val(""),i.refresh()),i.tmp.force_hide=!0;break;case 8:case 46:if("enum"===i.type&&8===s&&""===m.val()&&0<f.length){var v,w=f[f.length-1];if(!0===(v=i.trigger({phase:"before",type:"remove",target:i.el,originalEvent:e.originalEvent,item:w})).isCancelled)return;f.pop(),y(i.el).trigger("input").trigger("change"),i.refresh(),i.trigger(y.extend(v,{phase:"after"}))}"list"===i.type&&""===m.val()&&(y(i.el).data("selected",{}).change(),i.refresh());break;case 38:for(n.index=w2utils.isInt(n.index)?parseInt(n.index):0,n.index--;0<n.index&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index--;if(0===n.index&&(n.items[n.index].hidden||n.items[n.index].disabled))for(;n.items[n.index]&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index++;g=!0;break;case 40:for(n.index=w2utils.isInt(n.index)?parseInt(n.index):-1,n.index++;n.index<n.items.length-1&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index++;if(n.index==n.items.length-1&&(n.items[n.index].hidden||n.items[n.index].disabled))for(;n.items[n.index]&&(n.items[n.index].hidden||n.items[n.index].disabled);)n.index--;""===m.val()&&0===y("#w2ui-overlay").length?i.tmp.force_open=!0:g=!0}if(g)return n.index<0&&(n.index=0),n.index>=n.items.length&&(n.index=n.items.length-1),i.updateOverlay(g),e.preventDefault(),void setTimeout(function(){var e;"enum"===i.type||"list"===i.type?(e=m.get(0)).setSelectionRange(e.value.length,e.value.length):i.el.setSelectionRange(i.el.value.length,i.el.value.length)},0);"enum"===i.type&&m.width(8*(m.val().length+2)+"px")}},keyUp:function(e){var t,i;-1!==["list","combo","enum"].indexOf(this.type)&&(y(this.el).prop("readonly")||y(this.el).prop("disabled")||-1==[16,17,18,20,37,39,91].indexOf(e.keyCode)&&(0===(t=y(this.helpers.focus).find("input")).length&&(t=y(this.el)),!0!==(i=this.trigger({phase:"before",type:"search",originalEvent:e,target:t,search:t.val()})).isCancelled&&(this.tmp.force_hide||this.request(),1==t.val().length&&this.refresh(),0!==y("#w2ui-overlay").length&&-1!=[38,40].indexOf(e.keyCode)||this.search(),this.trigger(y.extend(i,{phase:"after"})))))},clearCache:function(){this.options.items=[],this.tmp.xhr_loading=!1,this.tmp.xhr_search="",this.tmp.xhr_total=-1},request:function(e){var t,a=this,r=this.options,l=y(a.el).val()||"";if(r.url){if("enum"===a.type&&(l=0===(t=y(a.helpers.multi).find("input")).length?"":t.val()),"list"===a.type&&(t=y(a.helpers.focus).find("input"),l=0===t.length?"":t.val()),0!==r.minLength&&l.length<r.minLength)return r.items=[],void this.updateOverlay();if(null==e&&(e=r.interval),null==a.tmp.xhr_search&&(a.tmp.xhr_search=""),null==a.tmp.xhr_total&&(a.tmp.xhr_total=-1),r.url&&(0===r.items.length&&0!==a.tmp.xhr_total||a.tmp.xhr_total==r.cacheMax&&l.length>a.tmp.xhr_search.length||l.length>=a.tmp.xhr_search.length&&l.substr(0,a.tmp.xhr_search.length)!==a.tmp.xhr_search||l.length<a.tmp.xhr_search.length)){if(a.tmp.xhr)try{a.tmp.xhr.abort()}catch(e){}a.tmp.xhr_loading=!0,a.search(),clearTimeout(a.tmp.timeout),a.tmp.timeout=setTimeout(function(){var e=r.url,o={search:l,max:r.cacheMax};y.extend(o,r.postData);var t=a.trigger({phase:"before",type:"request",search:l,target:a.el,url:e,postData:o});!0!==t.isCancelled&&(e={type:"GET",url:e=t.url,data:o=t.postData,dataType:"JSON"},r.method&&(e.type=r.method),"JSON"===w2utils.settings.dataType&&(e.type="POST",e.data=JSON.stringify(e.data),e.contentType="application/json"),"HTTPJSON"===w2utils.settings.dataType&&(e.data={request:JSON.stringify(e.data)}),null!=r.method&&(e.type=r.method),a.tmp.xhr=y.ajax(e).done(function(e,t,i){var n,s,i=a.trigger({phase:"before",type:"load",target:a.el,search:o.search,data:e,xhr:i});!0!==i.isCancelled&&(null==(e="string"==typeof(e=i.data)?JSON.parse(e):e).records&&null!=e.items&&(e.records=e.items,delete e.items),"success"===e.status&&null==e.records&&(e.records=[]),"success"===e.status&&Array.isArray(e.records)?(e.records.length>r.cacheMax&&e.records.splice(r.cacheMax,1e5),null==r.recId&&null!=r.recid&&(r.recId=r.recid),(r.recId||r.recText)&&e.records.forEach(function(e){"string"==typeof r.recId&&(e.id=e[r.recId]),"function"==typeof r.recId&&(e.id=r.recId(e)),"string"==typeof r.recText&&(e.text=e[r.recText]),"function"==typeof r.recText&&(e.text=r.recText(e))}),a.tmp.xhr_loading=!1,a.tmp.xhr_search=l,a.tmp.xhr_total=e.records.length,a.tmp.lastError="",r.items=a.normMenu(e.records),""===l&&0===e.records.length?a.tmp.emptySet=!0:a.tmp.emptySet=!1,(n=y(a.el).data("find_selected"))&&(Array.isArray(n)?(s=[],n.forEach(function(t){var i=!1;r.items.forEach(function(e){(e.id==t||t&&t.id==e.id)&&(s.push(y.extend(!0,{},e)),i=!0)}),i||s.push(t)})):(s=n,r.items.forEach(function(e){(e.id==n||n&&n.id==e.id)&&(s=e)})),y(a.el).data("selected",s).removeData("find_selected").change()),a.search(),a.trigger(y.extend(i,{phase:"after"}))):console.log("ERROR: server did not return proper structure. It should return",{status:"success",records:[{id:1,text:"item"}]}))}).fail(function(e,t,i){var n,i={status:t,error:i,rawResponseText:e.responseText},i=a.trigger({phase:"before",type:"error",target:a.el,search:l,error:i,xhr:e});if(!0!==i.isCancelled){if("abort"!==t){try{n=y.parseJSON(e.responseText)}catch(e){}console.log("ERROR: Server communication failed.","\n   EXPECTED:",{status:"success",records:[{id:1,text:"item"}]},"\n         OR:",{status:"error",message:"error message"},"\n   RECEIVED:","object"==typeof n?n:e.responseText)}a.tmp.xhr_loading=!1,a.tmp.xhr_search=l,a.tmp.xhr_total=0,a.tmp.emptySet=!0,a.tmp.lastError=i.error||"Server communication failed",r.items=[],a.clearCache(),a.search(),a.updateOverlay(!1),a.trigger(y.extend(i,{phase:"after"}))}}),a.trigger(y.extend(t,{phase:"after"})))},e)}}},search:function(){var e=this,t=this.options,i=y(e.el).val(),n=e.el,s=[],o=y(e.el).data("selected");if("enum"===e.type)for(var a in n=y(e.helpers.multi).find("input"),i=n.val(),o)o[a]&&s.push(o[a].id);else if("list"===e.type)for(var a in n=y(e.helpers.focus).find("input"),i=n.val(),o)o[a]&&s.push(o[a].id);var r=t.items;if(!0!==e.tmp.xhr_loading){for(var l=0,d=0;d<r.length;d++){var u=r[d];if(null!=t.compare)"function"==typeof t.compare&&(u.hidden=!1===t.compare.call(this,u,i));else{var c="",p="";-1!==["is","begins"].indexOf(t.match)&&(c="^"),-1!==["is","ends"].indexOf(t.match)&&(p="$");try{new RegExp(c+i+p,"i").test(u.text)||"..."===u.text?u.hidden=!1:u.hidden=!0}catch(e){}}!1===t.filter&&(u.hidden=!1),"enum"===e.type&&-1!==y.inArray(u.id,s)&&(u.hidden=!0),!0!==u.hidden&&(l++,delete u.hidden)}for(t.index=-1;r[t.index]&&r[t.index].hidden;)t.index++;l<=0&&(t.index=-1),t.spinner=!1,e.updateOverlay(),setTimeout(function(){var e=y("#w2ui-overlay").html()||"";t.markSearch&&-1!==e.indexOf("$.fn.w2menuHandler")&&y("#w2ui-overlay").w2marker(i)},1)}else r.splice(0,t.cacheMax),t.spinner=!0,e.updateOverlay()},updateOverlay:function(e){var t,s=this,o=this.options;if("color"===this.type){if(y(s.el).prop("readonly")||y(s.el).prop("disabled"))return;y(this.el).w2color({color:y(this.el).val(),transparent:o.transparent,advanced:o.advanced},function(e){null!=e&&y(s.el).val(e).trigger("input").change()})}if("date"===this.type){if(y(s.el).prop("readonly")||y(s.el).prop("disabled"))return;0===y("#w2ui-overlay").length&&y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(e){w2utils.isIE&&y(".w2ui-calendar").on("mousedown",function(e){e=y(e.target);1===e.length&&"w2ui-jump-year"===e[0].id&&y("#w2ui-overlay").data("keepOpen",!0)})}}),(t=w2utils.isDate(y(s.el).val(),s.options.format,!0))&&(l=t.getMonth()+1,d=t.getFullYear()),function i(e,t){y("#w2ui-overlay > div > div").html(s.getMonthHTML(e,t,y(s.el).val())),y("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var e,t;y(this).next().hasClass("w2ui-calendar-jump")?y(this).next().remove():(y(this).after('<div class="w2ui-calendar-jump" style=""></div>'),y(this).next().hide().html(s.getYearHTML()).fadeIn(200),setTimeout(function(){y("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){y(this).hasClass("w2ui-jump-month")&&(y(this).parent().find(".w2ui-jump-month").removeClass("selected"),y(this).addClass("selected"),t=y(this).attr("name")),y(this).hasClass("w2ui-jump-year")&&(y(this).parent().find(".w2ui-jump-year").removeClass("selected"),y(this).addClass("selected"),e=y(this).attr("name")),null!=e&&null!=t&&(y("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){i(parseInt(t)+1,e)},100))}),y("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),y("#w2ui-overlay .w2ui-date").on("mousedown",function(){var e=y(this).attr("date");y(s.el).val(e).trigger("input").change(),y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"})}).on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)}),y("#w2ui-overlay .previous").on("mousedown",function(){var e=s.options.current.split("/");e[0]=parseInt(e[0])-1,i(e[0],e[1])}),y("#w2ui-overlay .next").on("mousedown",function(){var e=s.options.current.split("/");e[0]=parseInt(e[0])+1,i(e[0],e[1])})}(l,d)}if("time"===this.type){if(y(s.el).prop("readonly")||y(s.el).prop("disabled"))return;0===y("#w2ui-overlay").length&&y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#fff"}});var i="h24"===this.options.format;y("#w2ui-overlay > div").html(s.getHourHTML()),y("#w2ui-overlay .w2ui-time").on("mousedown",function(e){y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var t=y(this).attr("hour");y(s.el).val((12<t&&!i?t-12:t)+":00"+(i?"":t<12?" am":" pm")).trigger("input").change()}),null==this.options.noMinutes||!1===this.options.noMinutes?y("#w2ui-overlay .w2ui-time").on("mouseup",function(){var t=y(this).attr("hour");0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide(),y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),y("#w2ui-overlay > div").html(s.getMinHTML(t)),y("#w2ui-overlay .w2ui-time").on("mousedown",function(){y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"});var e=y(this).attr("min");y(s.el).val((12<t&&!i?t-12:t)+":"+(e<10?0:"")+e+(i?"":t<12?" am":" pm")).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):y("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}if("datetime"===this.type){if(y(s.el).prop("readonly")||y(s.el).prop("disabled"))return;0<y("#w2ui-overlay .w2ui-time").length&&y("#w2ui-overlay")[0].hide(),0===y("#w2ui-overlay").length&&y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar" onclick="event.stopPropagation();"></div>',{css:{"background-color":"#f5f5f5"},onShow:function(e){w2utils.isIE&&y(".w2ui-calendar").on("mousedown",function(e){e=y(e.target);1===e.length&&"w2ui-jump-year"===e[0].id&&y("#w2ui-overlay").data("keepOpen",!0)})}}),(t=w2utils.isDateTime(y(s.el).val(),s.options.format,!0))&&(l=t.getMonth()+1,d=t.getFullYear());var n=null;!function i(e,t){y("#w2ui-overlay > div > div").html(s.getMonthHTML(e,t,y(s.el).val())+(o.btn_now?'<div class="w2ui-calendar-now now">'+w2utils.lang("Current Date & Time")+"</div>":"")),y("#w2ui-overlay .w2ui-calendar-title").on("mousedown",function(){var e,t;y(this).next().hasClass("w2ui-calendar-jump")?y(this).next().remove():(y(this).after('<div class="w2ui-calendar-jump" style=""></div>'),y(this).next().hide().html(s.getYearHTML()).fadeIn(200),setTimeout(function(){y("#w2ui-overlay .w2ui-calendar-jump").find(".w2ui-jump-month, .w2ui-jump-year").on("click",function(){y(this).hasClass("w2ui-jump-month")&&(y(this).parent().find(".w2ui-jump-month").removeClass("selected"),y(this).addClass("selected"),t=y(this).attr("name")),y(this).hasClass("w2ui-jump-year")&&(y(this).parent().find(".w2ui-jump-year").removeClass("selected"),y(this).addClass("selected"),e=y(this).attr("name")),null!=e&&null!=t&&(y("#w2ui-overlay .w2ui-calendar-jump").fadeOut(100),setTimeout(function(){i(parseInt(t)+1,e)},100))}),y("#w2ui-overlay .w2ui-calendar-jump >:last-child").prop("scrollTop",2e3)},1))}),y("#w2ui-overlay .w2ui-date").on("mousedown",function(){var e=y(this).attr("date");y(s.el).val(e).trigger("input").change(),y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),n=new Date(y(this).attr("data-date"))}).on("mouseup",function(){var i,t;0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide(),y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}});s.options.format;y("#w2ui-overlay > div").html(s.getHourHTML()),y("#w2ui-overlay .w2ui-time").on("mousedown",function(e){y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),i=y(this).attr("hour"),n.setHours(i);var t=w2utils.formatDateTime(n,s.options.format);y(s.el).val(t).trigger("input").change()}),null==s.options.noMinutes||!1===s.options.noMinutes?y("#w2ui-overlay .w2ui-time").on("mouseup",function(){var e=y(this).attr("hour");0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide(),y(s.el).w2overlay('<div class="w2ui-reset w2ui-calendar-time"></div>',{css:{"background-color":"#fff"}}),y("#w2ui-overlay > div").html(s.getMinHTML(e)),y("#w2ui-overlay .w2ui-time").on("mousedown",function(){y(this).css({"background-color":"#B6D5FB","border-color":"#aaa"}),t=y(this).attr("min"),n.setHours(i,t);var e=w2utils.formatDateTime(n,s.options.format);y(s.el).val(e).trigger("input").change()}).on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}):y("#w2ui-overlay .w2ui-time").on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}),y("#w2ui-overlay .previous").on("mousedown",function(){var e=s.options.current.split("/");e[0]=parseInt(e[0])-1,i(e[0],e[1])}),y("#w2ui-overlay .next").on("mousedown",function(){var e=s.options.current.split("/");e[0]=parseInt(e[0])+1,i(e[0],e[1])}),y("#w2ui-overlay .now").on("mousedown",function(){var e=w2utils.formatDateTime(new Date,s.options.format);return y(s.el).val(e).trigger("input").change(),!1}).on("mouseup",function(){setTimeout(function(){0<y("#w2ui-overlay").length&&y("#w2ui-overlay").removeData("keepOpen")[0].hide()},10)})}(l,d)}if(-1!==["list","combo","enum"].indexOf(this.type)){var a,r=this.el,l=this.el;if("enum"===this.type&&(r=y(this.helpers.multi),l=y(r).find("input")),"list"===this.type&&(a=y(l).data("selected"),y.isPlainObject(a)&&!y.isEmptyObject(a)&&-1==o.index&&o.items.forEach(function(e,t){e.id===a.id&&(o.index=t)}),l=y(this.helpers.focus).find("input")),y(this.el).hasClass("has-focus"))if(!1!==o.openOnFocus||""!==y(l).val()||!0===s.tmp.force_open){if(s.tmp.force_hide)return y().w2overlay(),void setTimeout(function(){delete s.tmp.force_hide},1);""!==y(l).val()&&delete s.tmp.force_open;var d=w2utils.lang("No matches");null!=o.url&&String(y(l).val()).length<o.minLength&&!0!==s.tmp.emptySet&&(d=o.minLength+" "+w2utils.lang("letters or more...")),null!=o.url&&""===y(l).val()&&!0!==s.tmp.emptySet&&(d=w2utils.lang(o.msgSearch||"Type to search...")),null==o.url&&0===o.items.length&&(d=w2utils.lang("Empty list")),null!=o.msgNoItems&&(l={search:y(l).val(),options:y.extend(!0,{},o)},o.url&&(l.remote={url:o.url,empty:!!s.tmp.emptySet,error:s.tmp.lastError,minLength:o.minLength}),d="function"==typeof o.msgNoItems?o.msgNoItems(l):o.msgNoItems),d=(d=s.tmp.lastError?s.tmp.lastError:d)&&'<div style="white-space: normal; line-height: 1.3">'+d+"</div>";var u=y.extend(!0,{},o,{search:!1,render:o.renderDrop,maxHeight:o.maxDropHeight,maxWidth:o.maxDropWidth,msgNoItems:d,onSelect:function(i){var e,t,n;"enum"===s.type?(e=y(s.el).data("selected"),!i.item||!0!==(t=s.trigger({phase:"before",type:"add",target:s.el,originalEvent:i.originalEvent,item:i.item})).isCancelled&&(e.length>=o.max&&0<o.max&&e.pop(),delete i.item.hidden,e.push(i.item),y(s.el).data("selected",e).trigger("input").change(),y(s.helpers.multi).find("input").val("").width(20),s.refresh(),!0!==i.keepOpen?0<y("#w2ui-overlay").length&&y("#w2ui-overlay")[0].hide():(u.items.forEach(function(e,t){e.id==i.item.id&&(n=t)}),null!=n&&u.items.splice(n,1),u.selected=e,y(r).w2menu("refresh",u)),s.trigger(y.extend(t,{phase:"after"})))):(y(s.el).data("selected",i.item).val(i.item.text).trigger("input").change(),s.helpers.focus&&s.helpers.focus.find("input").val(""))}});y(r).w2menu(e?"refresh-index":"refresh",u)}else y().w2overlay()}},inRange:function(e,t){var i,n,s,o=!1;if("date"===this.type){var a=w2utils.isDate(e,this.options.format,!0);if(a)if(this.options.start||this.options.end?(c="string"==typeof this.options.start?this.options.start:y(this.options.start).val(),p="string"==typeof this.options.end?this.options.end:y(this.options.end).val(),d=w2utils.isDate(c,this.options.format,!0),u=w2utils.isDate(p,this.options.format,!0),h=new Date(a),u=u||h,(d=d||h)<=h&&h<=u&&(o=!0)):o=!0,this.options.blocked&&-1!==y.inArray(e,this.options.blocked)&&(o=!1),null!==this.options.blockWeekDays&&void 0!==this.options.blockWeekDays&&null!=this.options.blockWeekDays.length)for(var r=this.options.blockWeekDays.length,l=0;l<r;l++)a.getDay()==this.options.blockWeekDays[l]&&(o=!1)}else if("time"===this.type)this.options.start||this.options.end?(i=this.toMin(e),n=this.toMin(this.options.start),s=(s=this.toMin(this.options.end))||i,(n=n||i)<=i&&i<=s&&(o=!0)):o=!0;else if("datetime"===this.type){var d,u,c,p,h,a=w2utils.isDateTime(e,this.options.format,!0);if(a)if(this.options.start||this.options.end?(h=a,d=(d="object"==typeof this.options.start&&this.options.start instanceof Date?this.options.start:""!==(c="string"==typeof this.options.start?this.options.start:y(this.options.start).val()).trim()?w2utils.isDateTime(c,this.options.format,!0):"")||h,u=(u="object"==typeof this.options.end&&this.options.end instanceof Date?this.options.end:""!==(p="string"==typeof this.options.end?this.options.end:y(this.options.end).val()).trim()?w2utils.isDateTime(p,this.options.format,!0):"")||h,t&&d instanceof Date&&(d.setHours(0),d.setMinutes(0),d.setSeconds(0)),d<=h&&h<=u&&(o=!0)):o=!0,o&&this.options.blocked)for(l=0;l<this.options.blocked.length;l++){var f=this.options.blocked[l];if("object"==typeof(f="string"==typeof f?w2utils.isDateTime(f,this.options.format,!0):f)&&f instanceof Date&&f.getFullYear()==a.getFullYear()&&f.getMonth()==a.getMonth()&&f.getDate()==a.getDate()){o=!1;break}}}return o},checkType:function(e,t){var i=this;switch(i.type){case"int":return t&&-1!==["-",i.options.groupSymbol].indexOf(e)?!0:w2utils.isInt(e.replace(i.options.numberRE,""));case"percent":e=e.replace(/%/g,"");case"float":return t&&-1!==["-",w2utils.settings.decimalSymbol,i.options.groupSymbol].indexOf(e)?!0:w2utils.isFloat(e.replace(i.options.numberRE,""));case"money":case"currency":return t&&-1!==["-",i.options.decimalSymbol,i.options.groupSymbol,i.options.currencyPrefix,i.options.currencySuffix].indexOf(e)?!0:w2utils.isFloat(e.replace(i.options.moneyRE,""));case"bin":return w2utils.isBin(e);case"hex":return w2utils.isHex(e);case"alphanumeric":return w2utils.isAlphaNumeric(e)}return!0},addPrefix:function(){var i=this;setTimeout(function(){var e;"clear"!==i.type&&((e=y(i.el).data("tmp")||{})["old-padding-left"]&&y(i.el).css("padding-left",e["old-padding-left"]),e["old-padding-left"]=y(i.el).css("padding-left"),y(i.el).data("tmp",e),i.helpers.prefix&&y(i.helpers.prefix).remove(),""!==i.options.prefix&&(y(i.el).before('<div class="w2ui-field-helper">'+i.options.prefix+"</div>"),(e=y(i.el).prev()).css({color:y(i.el).css("color"),"font-family":y(i.el).css("font-family"),"font-size":y(i.el).css("font-size"),"padding-top":y(i.el).css("padding-top"),"padding-bottom":y(i.el).css("padding-bottom"),"padding-left":y(i.el).css("padding-left"),"padding-right":0,"margin-top":parseInt(y(i.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(y(i.el).css("margin-bottom"),10)+1+"px","margin-left":y(i.el).css("margin-left"),"margin-right":0}).on("click",function(e){var t;i.options.icon&&"function"==typeof i.onIconClick?!0!==(t=i.trigger({phase:"before",type:"iconClick",target:i.el,el:y(this).find("span.w2ui-icon")[0]})).isCancelled&&i.trigger(y.extend(t,{phase:"after"})):("list"===i.type?y(i.helpers.focus).find("input"):y(i.el)).focus()}),y(i.el).css("padding-left",e.width()+parseInt(y(i.el).css("padding-left"),10)+"px"),i.helpers.prefix=e))},1)},addSuffix:function(){var t,i,s=this;setTimeout(function(){var e;"clear"!==s.type&&((e=y(s.el).data("tmp")||{})["old-padding-right"]&&y(s.el).css("padding-right",e["old-padding-right"]),e["old-padding-right"]=y(s.el).css("padding-right"),y(s.el).data("tmp",e),i=parseInt(y(s.el).css("padding-right"),10),s.options.arrows&&(s.helpers.arrows&&y(s.helpers.arrows).remove(),y(s.el).after('<div class="w2ui-field-helper" style="border: 1px solid transparent">&#160;    <div class="w2ui-field-up" type="up">        <div class="arrow-up" type="up"></div>    </div>    <div class="w2ui-field-down" type="down">        <div class="arrow-down" type="down"></div>    </div></div>'),(t=y(s.el).next()).css({color:y(s.el).css("color"),"font-family":y(s.el).css("font-family"),"font-size":y(s.el).css("font-size"),height:y(s.el).height()+parseInt(y(s.el).css("padding-top"),10)+parseInt(y(s.el).css("padding-bottom"),10)+"px",padding:0,"margin-top":parseInt(y(s.el).css("margin-top"),10)+1+"px","margin-bottom":0,"border-left":"1px solid silver"}).css("margin-left","-"+(t.width()+parseInt(y(s.el).css("margin-right"),10)+12)+"px").on("mousedown",function(t){var i=y("body");function n(e){y(s.el).focus(),s.keyDown(y.Event("keydown"),{keyCode:"up"===y(t.target).attr("type")?38:40}),!1!==e&&y("body").data("_field_update_timer",setTimeout(n,60))}i.on("mouseup",function e(){clearTimeout(i.data("_field_update_timer"));i.off("mouseup",e)}),i.data("_field_update_timer",setTimeout(n,700)),n(!1)}),i+=t.width()+12,y(s.el).css("padding-right",i+"px"),s.helpers.arrows=t),""!==s.options.suffix&&(s.helpers.suffix&&y(s.helpers.suffix).remove(),y(s.el).after('<div class="w2ui-field-helper">'+s.options.suffix+"</div>"),(t=y(s.el).next()).css({color:y(s.el).css("color"),"font-family":y(s.el).css("font-family"),"font-size":y(s.el).css("font-size"),"padding-top":y(s.el).css("padding-top"),"padding-bottom":y(s.el).css("padding-bottom"),"padding-left":"3px","padding-right":y(s.el).css("padding-right"),"margin-top":parseInt(y(s.el).css("margin-top"),10)+2+"px","margin-bottom":parseInt(y(s.el).css("margin-bottom"),10)+1+"px"}).on("click",function(e){("list"===s.type?y(s.helpers.focus).find("input"):y(s.el)).focus()}),t.css("margin-left","-"+(w2utils.getSize(t,"width")+parseInt(y(s.el).css("margin-right"),10)+2)+"px"),i+=t.width()+3,y(s.el).css("padding-right",i+"px"),s.helpers.suffix=t))},1)},addFocus:function(){var i,n=this;this.options;y(n.helpers.focus).remove();var e=parseInt(y(n.el).attr("tabIndex"));isNaN(e)||-1===e||(n.el._tabIndex=e),null==(e=n.el._tabIndex?n.el._tabIndex:e)&&(e=-1),isNaN(e)&&(e=0);var t="",e='<div class="w2ui-field-helper">    <div class="w2ui-icon icon-search" style="opacity: 0; display: none"></div>    <input '+(t=null!=y(n.el).attr("id")?'id="'+y(n.el).attr("id")+'_search"':t)+' type="text" tabIndex="'+e+'" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false"/></div>';y(n.el).attr("tabindex",-1).before(e);e=y(n.el).prev();(n.helpers.focus=e).css({width:y(n.el).width(),"margin-top":y(n.el).css("margin-top"),"margin-left":parseInt(y(n.el).css("margin-left"))+parseInt(y(n.el).css("padding-left"))+"px","margin-bottom":y(n.el).css("margin-bottom"),"margin-right":y(n.el).css("margin-right")}).find("input").css({cursor:"default",width:"100%",outline:"none",opacity:1,margin:0,border:"1px solid transparent",padding:y(n.el).css("padding-top"),"padding-left":0,"margin-left":0,"background-color":"transparent"}),e.find("input").on("click",function(e){0===y("#w2ui-overlay").length&&n.focus(e),e.stopPropagation()}).on("focus",function(e){i=y(n.el).attr("placeholder"),y(n.el).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"}),y(this).val(""),y(n.el).triggerHandler("focus"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("blur",function(e){y(n.el).css("outline","none"),y(this).val(""),n.refresh(),y(n.el).triggerHandler("blur"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,null!=i&&y(n.el).attr("placeholder",i)}).on("keydown",function(e){var t=this;n.keyDown(e),setTimeout(function(){""===t.value?y(n.el).attr("placeholder",i):y(n.el).attr("placeholder","")},10)}).on("keyup",function(e){n.keyUp(e)}).on("keypress",function(e){n.keyPress(e)}),e.on("click",function(e){y(this).find("input").focus()}),n.refresh()},addMulti:function(){var s=this;this.options;y(s.helpers.multi).remove();var e,t="",i="margin-top     : 0px; margin-bottom  : 0px; margin-left    : "+y(s.el).css("margin-left")+"; margin-right   : "+y(s.el).css("margin-right")+"; width          : "+(w2utils.getSize(s.el,"width")-parseInt(y(s.el).css("margin-left"),10)-parseInt(y(s.el).css("margin-right"),10))+"px;",n="";null!=y(s.el).attr("id")&&(n='id="'+y(s.el).attr("id")+'_search" '),"enum"===s.type&&((e=y(s.el).attr("tabIndex"))&&-1!==e&&(s.el._tabIndex=e),null==(e=s.el._tabIndex?s.el._tabIndex:e)&&(e=0),t='<div class="w2ui-field-helper w2ui-list" style="'+i+'; box-sizing: border-box">    <div style="padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">    <ul>        <li style="padding-left: 0px; padding-right: 0px" class="nomouse">            <input '+n+' type="text" style="width: 20px; margin: -3px 0 0; padding: 2px 0; border-color: white" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false"'+(y(s.el).prop("readonly")?' readonly="readonly"':"")+(y(s.el).prop("disabled")?' disabled="disabled"':"")+' tabindex="'+e+'"/>        </li>    </ul>    </div></div>'),"file"===s.type&&(t='<div class="w2ui-field-helper w2ui-list" style="'+i+'; box-sizing: border-box">   <div style="position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px;">       <input '+n+' name="attachment" class="file-input" type="file" style="width: 100%; height: 100%; opacity: 0;" tabindex="-1"'+(1!==s.options.max?' multiple="multiple"':"")+(y(s.el).prop("readonly")?' readonly="readonly"':"")+(y(s.el).prop("disabled")?' disabled="disabled"':"")+(y(s.el).attr("accept")?' accept="'+y(s.el).attr("accept")+'"':"")+'/>   </div>    <div style="position: absolute; padding: 0px; margin: 0px; display: inline-block" class="w2ui-multi-items">        <ul><li style="padding-left: 0px; padding-right: 0px" class="nomouse"></li></ul>    </div></div>');n=y(s.el).data("tmp")||{};n["old-background-color"]=y(s.el).css("background-color"),n["old-border-color"]=y(s.el).css("border-color"),y(s.el).data("tmp",n),y(s.el).before(t).css({"background-color":"transparent","border-color":"transparent"});var o=y(s.el).prev();s.helpers.multi=o,"enum"===s.type&&(y(s.el).attr("tabindex",-1),o.find("input").on("click",function(e){0===y("#w2ui-overlay").length&&s.focus(e),y(s.el).triggerHandler("click")}).on("focus",function(e){y(o).css({outline:"auto 5px #7DB4F3","outline-offset":"2px"}),y(s.el).triggerHandler("focus"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("blur",function(e){y(o).css("outline","none"),y(s.el).triggerHandler("blur"),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}).on("keyup",function(e){s.keyUp(e)}).on("keydown",function(e){s.keyDown(e)}).on("keypress",function(e){s.keyPress(e)}),o.on("click",function(e){y(this).find("input").focus()})),"file"===s.type&&(y(s.el).css("outline","none"),o.find("input").off(".drag").on("click.drag",function(e){e.stopPropagation(),y(s.el).prop("readonly")||y(s.el).prop("disabled")||y(s.el).focus()}).on("dragenter.drag",function(e){y(s.el).prop("readonly")||y(s.el).prop("disabled")||y(o).addClass("w2ui-file-dragover")}).on("dragleave.drag",function(e){y(s.el).prop("readonly")||y(s.el).prop("disabled")||y(o).removeClass("w2ui-file-dragover")}).on("drop.drag",function(e){if(!y(s.el).prop("readonly")&&!y(s.el).prop("disabled")){y(o).removeClass("w2ui-file-dragover");for(var t=e.originalEvent.dataTransfer.files,i=0,n=t.length;i<n;i++)s.addFile.call(s,t[i]);y(s.el).focus(),e.preventDefault(),e.stopPropagation()}}).on("dragover.drag",function(e){e.preventDefault(),e.stopPropagation()}).on("change.drag",function(){if(y(s.el).focus(),void 0!==this.files)for(var e=0,t=this.files.length;e<t;e++)s.addFile.call(s,this.files[e])})),s.refresh()},addFile:function(e){var t,i=this,n=this.options,s=y(i.el).data("selected"),o={name:e.name,type:e.type,modified:e.lastModifiedDate,size:e.size,content:null,file:e},a=0,r=0;if(s)for(var l=0;l<s.length;l++){if(s[l].name==e.name&&s[l].size==e.size)return;a+=s[l].size,r++}var d=i.trigger({phase:"before",type:"add",target:i.el,file:o,total:r,totalSize:a});if(!0!==d.isCancelled)return 0!==n.maxFileSize&&o.size>n.maxFileSize?(t="Maximum file size is "+w2utils.formatSize(n.maxFileSize),!1===n.silent&&y(i.el).w2tag(t),void console.log("ERROR: "+t)):0!==n.maxSize&&a+o.size>n.maxSize?(t=w2utils.lang("Maximum total size is")+" "+w2utils.formatSize(n.maxSize),void(!1===n.silent?y(i.el).w2tag(t):console.log("ERROR: "+t))):0!==n.max&&r>=n.max?(t=w2utils.lang("Maximum number of files is")+" "+n.max,void(!1===n.silent?y(i.el).w2tag(t):console.log("ERROR: "+t))):(s.push(o),void("undefined"!=typeof FileReader&&!0===n.readContent?((n=new FileReader).onload=function(e){var t=e.target.result,e=t.indexOf(",");o.content=t.substr(e+1),i.refresh(),y(i.el).trigger("input").trigger("change"),i.trigger(y.extend(d,{phase:"after"}))},n.readAsDataURL(e)):(i.refresh(),y(i.el).trigger("input").trigger("change"),i.trigger(y.extend(d,{phase:"after"})))))},normMenu:function(e,t){if(y.isArray(e)){for(var i=0;i<e.length;i++)"string"==typeof e[i]?e[i]={id:e[i],text:e[i]}:null!=e[i]?(null!=e[i].text&&null==e[i].id&&(e[i].id=e[i].text),null==e[i].text&&null!=e[i].id&&(e[i].text=e[i].id),null!=e[i].caption&&(e[i].text=e[i].caption)):e[i]={id:null,text:"null"};return e}if("function"==typeof e)return w2obj.field.prototype.normMenu.call(this,e.call(this,t));if("object"==typeof e){var n=[];for(i in e)n.push({id:i,text:e[i]});return n}},getMonthHTML:function(e,t,i){var n=new Date,s=w2utils.settings.fullmonths,o=["31","28","31","30","31","30","31","31","30","31","30","31"],a=n.getFullYear()+"/"+(Number(n.getMonth())+1)+"/"+n.getDate(),r=w2utils.settings.fulldays.slice(),l=w2utils.settings.shortdays.slice();"M"!==w2utils.settings.weekStarts&&(r.unshift(r.pop()),l.unshift(l.pop()));var d=this.options;null==d&&(d={}),t=w2utils.isInt(t)?parseInt(t):n.getFullYear(),12<(e=w2utils.isInt(e)?parseInt(e):n.getMonth()+1)&&(e-=12,t++),(e<1||0===e)&&(e+=12,t--),t/4==Math.floor(t/4)?o[1]="29":o[1]="28",d.current=e+"/"+t;for(var u=(n=new Date(t,e-1,1)).getDay(),c="",p=0;p<l.length;p++)c+='<td title="'+r[p]+'">'+l[p]+"</td>";var h='<div class="w2ui-calendar-title title">    <div class="w2ui-calendar-previous previous"> <div></div> </div>    <div class="w2ui-calendar-next next"> <div></div> </div> '+s[e-1]+", "+t+'</div><table class="w2ui-calendar-days" cellspacing="0"><tbody>    <tr class="w2ui-day-title">'+c+"</tr>    <tr>",f=1;"M"!==w2utils.settings.weekStarts&&u++,"datetime"===this.type&&(s=w2utils.isDateTime(i,d.format,!0),i=w2utils.formatDate(s,w2utils.settings.dateFormat));for(var m=1;m<43;m++){if(0===u&&1==m){for(var g=0;g<6;g++)h+='<td class="w2ui-day-empty">&#160;</td>';m+=6}else if(m<u||f>o[e-1]){h+='<td class="w2ui-day-empty">&#160;</td>',m%7==0&&(h+="</tr><tr>");continue}var w=t+"/"+e+"/"+f,v=new Date(w),y="";6===v.getDay()&&(y=" w2ui-saturday"),0===v.getDay()&&(y=" w2ui-sunday"),w==a&&(y+=" w2ui-today");var x,b=f,k="",T="",C="datetime"===this.type?(x=w2utils.formatDateTime(w,d.format),w2utils.formatDate(w,w2utils.settings.dateFormat)):x=w2utils.formatDate(w,d.format);d.colored&&void 0!==d.colored[C]&&(T="background-color: "+(w=d.colored[C].split(":"))[0]+";",k="color: "+w[1]+";"),h+='<td class="'+(this.inRange(x,!0)?"w2ui-date "+(C==i?"w2ui-date-selected":""):"w2ui-blocked")+y+'"    style="'+k+T+'" date="'+x+'" data-date="'+v+'">'+b+"</td>",(m%7==0||0===u&&1==m)&&(h+="</tr><tr>"),f++}return h+="</tr></tbody></table>"},getYearHTML:function(){for(var e=w2utils.settings.shortmonths,t=w2utils.settings.dateStartYear,i=w2utils.settings.dateEndYear,n="",s="",o=0;o<e.length;o++)n+='<div class="w2ui-jump-month" name="'+o+'">'+e[o]+"</div>";for(var a=t;a<=i;a++)s+='<div class="w2ui-jump-year" name="'+a+'">'+a+"</div>";return'<div id="w2ui-jump-month">'+n+'</div><div id="w2ui-jump-year">'+s+"</div>"},getHourHTML:function(){for(var e=[],t=this.options,i=-1<(t=null==t?{format:w2utils.settings.timeFormat}:t).format.indexOf("h24"),n=0;n<24;n++){var s=12!=n||i?(12<=n&&!i?n-12:n)+":00"+(i?"":n<12?" am":" pm"):"12:00 pm";e[Math.floor(n/8)]||(e[Math.floor(n/8)]="");var o,a,r=this.fromMin(this.toMin(s)),l=this.fromMin(this.toMin(s)+59);"datetime"===this.type&&(o=w2utils.isDateTime(this.el.value,t.format,!0),a=t.format.split("|")[0].trim(),r=w2utils.formatDate(o,a)+" "+r,l=w2utils.formatDate(o,a)+" "+l),e[Math.floor(n/8)]+='<div class="'+(this.inRange(r)||this.inRange(l)?"w2ui-time ":"w2ui-blocked")+'" hour="'+n+'">'+s+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Hour")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+e[0]+"</td>       <td>"+e[1]+"</td>       <td>"+e[2]+"</td>   </tr></tbody></table></div></div>"},getMinHTML:function(e){null==e&&(e=0);for(var t=this.options,i=-1<(t=null==t?{format:w2utils.settings.timeFormat}:t).format.indexOf("h24"),n=[],s=0;s<60;s+=5){var o,a,r=(12<e&&!i?e-12:e)+":"+(s<10?0:"")+s+" "+(i?"":e<12?"am":"pm"),l=r,d=s<20?0:s<40?1:2;n[d]||(n[d]=""),"datetime"===this.type&&(o=w2utils.isDateTime(this.el.value,t.format,!0),a=t.format.split("|")[0].trim(),l=w2utils.formatDate(o,a)+" "+l),n[d]+='<div class="'+(this.inRange(l)?"w2ui-time ":"w2ui-blocked")+'" min="'+s+'">'+r+"</div>"}return'<div class="w2ui-calendar">   <div class="w2ui-calendar-title">'+w2utils.lang("Select Minute")+'</div>   <div class="w2ui-calendar-time"><table><tbody><tr>       <td>'+n[0]+"</td>       <td>"+n[1]+"</td>       <td>"+n[2]+"</td>   </tr></tbody></table></div></div>"},toMin:function(e){if("string"!=typeof e)return null;var t=e.split(":");return 2!==t.length?null:(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),-1!==e.indexOf("pm")&&12!==t[0]&&(t[0]+=12),60*t[0]+t[1])},fromMin:function(e){1440<=e&&(e%=1440),e<0&&(e=1440+e);var t=Math.floor(e/60),i=(e%60<10?"0":"")+e%60,e=this.options;return-1!==(e=null==e?{format:w2utils.settings.timeFormat}:e).format.indexOf("h24")?t+":"+i:(t<=12?t:t-12)+":"+i+" "+(12<=t?"pm":"am")}},y.extend(s.prototype,w2utils.event),w2obj.field=s}(jQuery);